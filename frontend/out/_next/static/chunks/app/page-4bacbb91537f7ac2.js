(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7846:function(e,t,s){Promise.resolve().then(s.bind(s,6774))},6774:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),n=s(2265),l=s(2757),i=s(2513),r=s(3787),o=s(6264),c=s(7138),d=s(6463),u=s(357);function m(e){let{children:t}=e;return(0,a.jsx)("div",{className:"bg-white border rounded-none shadow-sm",children:t})}function h(e){let{children:t,className:s=""}=e;return(0,a.jsx)("div",{className:"px-4 pt-4 ".concat(s),children:t})}function x(e){let{children:t,className:s=""}=e;return(0,a.jsx)("h3",{className:"font-semibold ".concat(s),children:t})}function f(e){let{children:t,className:s=""}=e;return(0,a.jsx)("div",{className:"px-4 pb-4 ".concat(s),children:t})}function p(){let[e,t]=(0,n.useState)([]),[s,p]=(0,n.useState)(!0),[g,b]=(0,n.useState)(!1),[v,j]=(0,n.useState)(!1),[N,y]=(0,n.useState)("irrakids"),w=(0,d.useRouter)(),k=u.env.NEXT_PUBLIC_API_BASE_URL||"";(0,n.useEffect)(()=>{(async()=>{try{let e="irrakids";try{e=localStorage.getItem("ptos_store")||"irrakids"}catch(e){}y(e);let s=await (0,o.Rd)(void 0,e);t((null==s?void 0:s.data)||[])}finally{p(!1)}})()},[]);let _=u.env.NEXT_PUBLIC_STUDIO_URL||"";async function C(e){try{j(!0);let t=await (0,o.DO)({product:{audience:"",benefits:[],pain_points:[]},settings:{flow_type:e,store:N}}),s=null==t?void 0:t.id;if(!s){j(!1),b(!1);return}let a="&store=".concat(encodeURIComponent(N));"ads"===e?w.push("/ads/?id=".concat(s).concat(a)):"promotion"===e?w.push("/promotion/?id=".concat(s).concat(a)):w.push("/studio/?id=".concat(s).concat(a))}catch(e){}finally{j(!1),b(!1)}}return(0,a.jsxs)("div",{className:"min-h-screen w-full bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-sky-50 via-white to-indigo-50 text-slate-800",children:[(0,a.jsxs)("header",{className:"h-16 px-4 md:px-6 flex items-center justify-between border-b bg-white/70 backdrop-blur sticky top-0 z-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(l.Z,{className:"w-6 h-6 text-blue-600"}),(0,a.jsx)("h1",{className:"font-semibold text-lg",children:"Product Testing OS — Flows"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("select",{value:N,onChange:async e=>{let s=e.target.value;y(s);try{localStorage.setItem("ptos_store",s)}catch(e){}p(!0);try{let e=await (0,o.Rd)(void 0,s);t((null==e?void 0:e.data)||[])}finally{p(!1)}},className:"rounded-xl border px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"irrakids",children:"irrakids"}),(0,a.jsx)("option",{value:"irranova",children:"irranova"})]}),(0,a.jsx)(c.default,{href:"/",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:"Home"}),(0,a.jsx)(c.default,{href:"/ads-management",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white",children:"Ads management"}),(0,a.jsx)(c.default,{href:"/shopify-connect",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 border bg-white hover:bg-slate-50",children:"Shopify Connect"}),(0,a.jsx)(c.default,{href:"/confirmation",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-slate-900 hover:bg-slate-950 text-white",children:"Confirmation"}),(0,a.jsx)(c.default,{href:"/confirmation-admin",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white",children:"Confirmation Admin"}),(0,a.jsxs)("button",{onClick:()=>b(!0),className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"})," New flow"]})]})]}),(0,a.jsxs)("div",{className:"p-4 md:p-6",children:[s&&(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"Loading…"}),!s&&0===e.length&&(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["No flows yet. Click ",(0,a.jsx)("span",{className:"font-medium",children:"New flow"})," to start."]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:e.map(e=>{let s=e.flow_type||"product",n="&store=".concat(encodeURIComponent(N)),l="ads"===s?"/ads/?id=".concat(e.id).concat(n):"promotion"===s?"/promotion/?id=".concat(e.id).concat(n):_?"".concat(_,"?id=").concat(e.id).concat(n):"/studio/?id=".concat(e.id).concat(n);async function i(s){s.preventDefault(),s.stopPropagation();try{if(!window.confirm("Delete this flow permanently? This will remove its local uploads."))return;let s=await (0,o.fE)(e.id);if(null==s?void 0:s.error){alert(String(s.error));return}t(t=>t.filter(t=>t.id!==e.id))}catch(e){alert("Delete failed: "+String((null==e?void 0:e.message)||e))}}return(0,a.jsx)(c.default,{href:l,className:"block",children:(0,a.jsxs)(m,{children:[(0,a.jsx)(h,{className:"pb-2",children:(0,a.jsxs)(x,{className:"text-base flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)("span",{children:(null==e?void 0:e.title)||"Untitled flow"}),(0,a.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded ".concat("ads"===s?"bg-emerald-100 text-emerald-700":"promotion"===s?"bg-fuchsia-100 text-fuchsia-700":"bg-blue-100 text-blue-700"),children:"ads"===s?"Create Ads":"promotion"===s?"Create Promotion":"Create Product"})]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{title:"Delete",onClick:i,className:"p-1 rounded hover:bg-slate-50 text-slate-500",children:"\xd7"}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.created_at||Date.now()).toLocaleDateString()})]})]})}),(0,a.jsxs)(f,{className:"space-y-2",children:[(0,a.jsx)("div",{className:"w-full bg-slate-100 rounded-none overflow-hidden border h-28 md:h-32",children:e.card_image?(0,a.jsx)("img",{src:function(e){try{if(!e||e.startsWith("/")||!/^https?:\/\//i.test(e))return e;let t=new URL(e).host,s="";try{s=k?new URL(k).host:window.location.host}catch(e){}return["cdn.shopify.com","images.openai.com","oaidalleapiprodscus.blob.core.windows.net"].some(e=>t===e||t.endsWith("."+e))||s&&t===s?e:"".concat(k,"/proxy/image?url=").concat(encodeURIComponent(e))}catch(t){return e}}(e.card_image),alt:"cover",className:"w-full h-full object-cover",loading:"lazy"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-slate-400 text-sm",children:"No image"})}),e.page_url&&(0,a.jsxs)("a",{href:e.page_url,target:"_blank",className:"text-sm inline-flex items-center gap-1 text-blue-600 hover:underline",children:[(0,a.jsx)(r.Z,{className:"w-3.5 h-3.5"})," ",e.page_url]}),!e.page_url&&(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"No Shopify page yet"})]})]})},e.id)})})]}),g&&(0,a.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/30",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border shadow-xl w-[92vw] max-w-md p-4",children:[(0,a.jsx)("div",{className:"text-base font-semibold mb-2",children:"Choose a flow"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,a.jsxs)("button",{disabled:v,onClick:()=>C("product"),className:"border rounded-lg p-3 text-left hover:bg-slate-50",children:[(0,a.jsx)("div",{className:"font-medium",children:"Create Product"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"From product inputs to landing page"})]}),(0,a.jsxs)("button",{disabled:v,onClick:()=>C("ads"),className:"border rounded-lg p-3 text-left hover:bg-slate-50",children:[(0,a.jsx)("div",{className:"font-medium",children:"Create Ads"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Analyze landing URL, angles, copy, images"})]}),(0,a.jsxs)("button",{disabled:v,onClick:()=>C("promotion"),className:"border rounded-lg p-3 text-left hover:bg-slate-50",children:[(0,a.jsx)("div",{className:"font-medium",children:"Create Promotion"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Specialized for offers and promotional images"})]})]}),(0,a.jsx)("div",{className:"mt-3 flex justify-end gap-2",children:(0,a.jsx)("button",{onClick:()=>b(!1),className:"text-sm px-3 py-1.5 rounded border",children:"Cancel"})})]})})]})}},3787:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},2513:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2757:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},7138:function(e,t,s){"use strict";s.d(t,{default:function(){return n.a}});var a=s(231),n=s.n(a)},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[472,231,264,971,23,744],function(){return e(e.s=7846)}),_N_E=e.O()}]);
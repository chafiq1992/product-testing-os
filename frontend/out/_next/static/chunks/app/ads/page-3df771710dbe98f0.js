(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418],{4137:function(e,a,t){Promise.resolve().then(t.bind(t,9619))},9619:function(e,a,t){"use strict";t.d(a,{default:function(){return j}});var s=t(7437),i=t(2265),l=t(6463),n=t(7138),r=t(2757);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,t(8030).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var o=t(399),c=t(6264),p=t(357);function m(e){let{children:a,onClick:t,disabled:i,variant:l="default",size:n="md"}=e;return(0,s.jsx)("button",{onClick:t,disabled:i,className:"".concat("rounded-xl font-semibold transition inline-flex items-center justify-center"," ").concat("sm"===n?"text-sm px-3 py-1.5":"px-4 py-2"," ").concat("outline"===l?"border border-slate-300 text-slate-700 bg-white hover:bg-slate-50 disabled:opacity-60":"bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-60"),children:a})}function u(e){let{children:a}=e;return(0,s.jsx)("div",{className:"bg-white border rounded-2xl shadow-sm",children:a})}function h(e){let{children:a,className:t=""}=e;return(0,s.jsx)("div",{className:"px-4 pt-4 ".concat(t),children:a})}function x(e){let{children:a,className:t=""}=e;return(0,s.jsx)("h3",{className:"font-semibold ".concat(t),children:a})}function g(e){let{children:a,className:t=""}=e;return(0,s.jsx)("div",{className:"px-4 pb-4 ".concat(t),children:a})}function v(e){return(0,s.jsx)("input",{...e,className:"w-full rounded-xl border px-3 py-2 ".concat(e.className||"")})}function f(e){return(0,s.jsx)("textarea",{...e,className:"w-full rounded-xl border px-3 py-2 ".concat(e.className||"")})}function y(e){let{className:a=""}=e;return(0,s.jsx)("div",{className:"border-t ".concat(a)})}function j(){var e,a,t,j,b,A,w,S,k,C,I,E,O,R,M,P,z,L,U,D;let B=(0,l.useSearchParams)(),T=B.get("id")||B.get("flow")||"",F=B.get("store");(0,i.useEffect)(()=>{try{F&&localStorage.setItem("ptos_store",F)}catch(e){}},[F]);let[G,J]=(0,i.useState)(""),[H,Y]=(0,i.useState)("Shoppers likely to buy this product"),[V,X]=(0,i.useState)(""),[W,Z]=(0,i.useState)(""),[q,K]=(0,i.useState)(""),[Q,$]=(0,i.useState)(""),[ee,ea]=(0,i.useState)(""),[et,es]=(0,i.useState)(""),[ei,el]=(0,i.useState)([]),[en,er]=(0,i.useState)({audience:"manual",benefits:"manual",pains:"manual",offers:"manual",emotions:"manual",title:"manual",sourceImage:"manual"}),ed=p.env.NEXT_PUBLIC_API_BASE_URL||"";function eo(e){try{if(!e||e.startsWith("/")||!/^https?:\/\//i.test(e))return e;let a=new URL(e).host,t="";try{t=ed?new URL(ed).host:window.location.host}catch(e){}return["cdn.shopify.com","images.openai.com","oaidalleapiprodscus.blob.core.windows.net"].some(e=>a===e||a.endsWith("."+e))||t&&a===t?e:"".concat(ed,"/proxy/image?url=").concat(encodeURIComponent(e))}catch(a){return e}}let[ec,ep]=(0,i.useState)(3),[em,eu]=(0,i.useState)([]),[eh,ex]=(0,i.useState)(0),[eg,ev]=(0,i.useState)([]),[ef,ey]=(0,i.useState)(""),[ej,e_]=(0,i.useState)(""),[eN,eb]=(0,i.useState)(""),[eA,ew]=(0,i.useState)([]),[eS,ek]=(0,i.useState)("SHOP_NOW"),[eC,eI]=(0,i.useState)(9),[eE,eO]=(0,i.useState)(!0),[eR,eM]=(0,i.useState)("gpt-5"),[eP,ez]=(0,i.useState)(""),[eL,eU]=(0,i.useState)(""),[eD,eB]=(0,i.useState)([]),[eT,eF]=(0,i.useState)(!1),[eG,eJ]=(0,i.useState)(!1),[eH,eY]=(0,i.useState)(T||""),eV=(0,i.useRef)({});async function eX(){if(eH)return eH;let e={audience:H,benefits:W.split("\n").map(e=>e.trim()).filter(Boolean),pain_points:q.split("\n").map(e=>e.trim()).filter(Boolean),title:V||void 0},a={flow_type:"ads",adset_budget:eC,advantage_plus:eE,model:eR};eP&&(a.countries=eP.split(",").map(e=>e.trim()).filter(Boolean)),eL&&(a.saved_audience_id=eL);let t=await (0,c.DO)({product:e,image_urls:ei,settings:a,prompts:{analyze_landing_prompt:e4,headlines_prompt:e$,copies_prompt:e1,gemini_ad_prompt:e5},ui:{zoom:ap,pan:au,selected_node:ag,active_left_tab:ao},flow:{nodes:aw,edges:ak}});eY(t.id);try{let e=new URL(window.location.href);e.searchParams.set("id",t.id),window.history.replaceState({},"",e.toString())}catch(e){}return t.id}async function eW(e){if(eH)try{let a={selectedHeadline:ef,selectedPrimary:ej,selectedImage:eN,selectedImages:eA,cta:eS,budget:eC,advantagePlus:eE,countries:eP,savedAudienceId:eL,candidateImages:ei,adImages:eg,...function(){let e=aw.filter(e=>"angle_variant"===e.type).map(e=>{var a;let t=e.id,s=aw.filter(e=>{var a;return"headlines_out"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===t}).flatMap(e=>{var a;return Array.isArray(null===(a=e.data)||void 0===a?void 0:a.headlines)?e.data.headlines:[]}),i=aw.filter(e=>{var a;return"copies_out"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===t}).flatMap(e=>{var a;return Array.isArray(null===(a=e.data)||void 0===a?void 0:a.primaries)?e.data.primaries:[]}),l=aw.filter(e=>{var a;return"images_out"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===t}).flatMap(e=>{var a;return Array.isArray(null===(a=e.data)||void 0===a?void 0:a.images)?e.data.images:[]});return{angle:(null===(a=e.data)||void 0===a?void 0:a.angle)||{},headlines:s.slice(0,12),primaries:i.slice(0,12),images:l.slice(0,12)}});return{landing_url:G,source_image:et||ei[1]||ei[0]||"",angles:em,per_angle:e}}(),...e||{}},t={audience:H,benefits:W.split("\n").filter(Boolean),pain_points:q.split("\n").filter(Boolean),title:V||void 0};await (0,c.XD)(eH,{product:t,ads:a,prompts:{analyze_landing_prompt:e4,headlines_prompt:e$,copies_prompt:e1,gemini_ad_prompt:e5},settings:{flow_type:"ads",adset_budget:eC,advantage_plus:eE,model:eR},ui:{zoom:ap,pan:au,selected_node:ag,active_left_tab:ao},flow:{nodes:aw,edges:ak}})}catch(e){}}async function eZ(){let e=await eX();try{if(!eV.current[e]){let a=await (0,c.yp)({flow_id:e,landing_url:G||void 0,source_image:et||ei[1]||ei[0]||void 0,num_angles:3,prompts:{analyze_landing_prompt:e4,angles_prompt:eK,headlines_prompt:e$,copies_prompt:e1,gemini_ad_prompt:e5},model:eR});a&&!a.error&&(eV.current[e]=!0)}}catch(e){}(async()=>{for(;eG&&(!G||!et);)G&&!et&&ei.length>1&&es(ei[1]),await new Promise(e=>setTimeout(e,400));if(!eG||(G&&(!ei||0===ei.length)&&await aN(),await eW(),!eG))return;aR(),a_({step:"generate_angles"});let e=await eq();if(await eW(),!eG)return;let a=e&&e.length>0?e:aI.current.filter(e=>"angle_variant"===e.type).slice(0,3);for(let e=0;e<a.length;e++){let t=a[e];if(!eG)break;await aD(t.id),await new Promise(e=>setTimeout(e,250));let s=aI.current.find(e=>{var a;return"headlines"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===t.id}),i=aI.current.find(e=>{var a;return"copies"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===t.id}),l=aI.current.find(e=>{var a;return"gemini_images"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===t.id});a_({step:"generate_headlines",angle_index:e}),s&&await aP(s.id),a_({step:"generate_copies",angle_index:e}),i&&await az(i.id),a_({step:"generate_images",angle_index:e}),l&&await aL(l.id),await eW()}a_(null)})()}async function eq(){try{eF(!0);let e={audience:H,benefits:W.split("\n").map(e=>e.trim()).filter(Boolean),pain_points:q.split("\n").map(e=>e.trim()).filter(Boolean),title:V||void 0},a=await (0,c.PN)({product:e,num_angles:3,prompt:eK||void 0,model:eR}),t=Array.isArray(null==a?void 0:a.angles)?a.angles:[];eu(t);let s=aI.current.find(e=>"landing"===e.type)||aI.current[0],i=aI.current.find(e=>"angles"===e.type);!i&&s&&(i=aE("angles",s,{},{x:s.x+300,y:s.y}),aO(s,i));let l=[],n=Math.min(3,Math.max(0,t.length||3));for(let e=0;e<n;e++){let a=t[e]||{name:"Angle ".concat(e+1)},s=aM("angle_variant",i,{angle:a,angleIndex:e},e,n);l.push(s)}return l}catch(e){return alert("Angles generation failed: "+String((null==e?void 0:e.message)||e)),[]}finally{eF(!1)}}(0,i.useEffect)(()=>{(async()=>{if(T)try{let a=await (0,c.ME)(T);try{var e;let t=(null==a?void 0:a.ui)||{};"number"==typeof t.zoom&&am(t.zoom),t.pan&&"number"==typeof t.pan.x&&"number"==typeof t.pan.y&&ah({x:t.pan.x,y:t.pan.y}),"string"==typeof t.selected_node&&av(t.selected_node),"string"==typeof t.active_left_tab&&("inputs"===t.active_left_tab||"prompts"===t.active_left_tab)&&ac(t.active_left_tab);let s=null==a?void 0:null===(e=a.settings)||void 0===e?void 0:e.model;"string"==typeof s&&eM(s)}catch(e){}try{let e=(null==a?void 0:a.flow)||{},t=Array.isArray(null==e?void 0:e.nodes)?e.nodes:[],s=Array.isArray(null==e?void 0:e.edges)?e.edges:[];if(t.length>0){aS(t),aC(s);try{let e=t.map(e=>Number(String((null==e?void 0:e.id)||"").replace(/[^0-9]/g,""))).filter(e=>Number.isFinite(e)),a=e.length>0?Math.max(...e):0;ab.current=Math.max(ab.current,a+1)}catch(e){}}}catch(e){}let t=(null==a?void 0:a.ads)||{};"string"==typeof t.selectedHeadline&&ey(t.selectedHeadline),"string"==typeof t.selectedPrimary&&e_(t.selectedPrimary),"string"==typeof t.cta&&ek(t.cta),"number"==typeof t.budget&&eI(t.budget),"boolean"==typeof t.advantagePlus&&eO(t.advantagePlus),"string"==typeof t.savedAudienceId&&eU(t.savedAudienceId),"string"==typeof t.countries&&ez(t.countries);let s=Array.isArray(t.adImages)?t.adImages:[];s.length>0&&ev(s);try{let e=(null==a?void 0:a.prompts)||{};"string"==typeof e.headlines_prompt?e0(e.headlines_prompt):"string"==typeof e.angles_prompt&&e0(e.angles_prompt),"string"==typeof e.copies_prompt&&e2(e.copies_prompt),"string"==typeof e.gemini_ad_prompt&&e3(e.gemini_ad_prompt),"string"==typeof e.analyze_landing_prompt&&e6(e.analyze_landing_prompt)}catch(e){}}catch(e){}})()},[T]),(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,c.l9)(),a=Array.isArray(null==e?void 0:e.data)?e.data:[];eB(a)}catch(e){eB([])}})()},[]),(0,i.useEffect)(()=>{try{let e=localStorage.getItem("ptos_ads_auto_run");null!=e&&eJ("1"===e)}catch(e){}},[]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_ads_auto_run",eG?"1":"0")}catch(e){}},[eG]),(0,i.useEffect)(()=>{if(!eH)return;let e=!1,a=async()=>{try{let e=await (0,c.ME)(eH),a=(null==e?void 0:e.ads)||{};try{var t;let e=((Array.isArray(null==a?void 0:null===(t=a.analyze)||void 0===t?void 0:t.images)?a.analyze.images:[])||[]).filter(e=>"string"==typeof e&&e),s=e.slice(1),i=s.length>0?s:e;G&&i.length>0&&0===ei.length&&(el(i.slice(0,10)),et||es(i[0]))}catch(e){}try{let e=[];for(let t of(null==a?void 0:a.per_angle)||[])for(let a of(null==t?void 0:t.images)||[])"string"==typeof a&&a&&e.push(a);e.length>0&&ev(a=>{let t=new Set([...a||[],...e]);return Array.from(t)})}catch(e){}try{0===em.length&&Array.isArray(null==a?void 0:a.angles)&&a.angles.length>0&&eu(a.angles)}catch(e){}try{!function(e){if(!e||"object"!=typeof e)return;let a=Array.isArray(e.angles)?e.angles:[];if(a.length>0){let e=aI.current,t=e.find(e=>"landing"===e.type)||e[0],s=e.find(e=>"angles"===e.type);if(s||(s=aE("angles",t,{},{x:t.x+300,y:t.y}),aO(t,s)),0===e.filter(e=>"angle_variant"===e.type).length){let e=Math.min(3,a.length);for(let t=0;t<e;t++){let i=a[t],l=aM("angle_variant",s,{angle:i,angleIndex:t},t,e);aM("headlines",l,{angle:i,angleId:l.id,angleIndex:t},0,3),aM("copies",l,{angle:i,angleId:l.id,angleIndex:t},1,3),aM("gemini_images",l,{from:et||ei[1]||ei[0]||"",angle:i,angleId:l.id,angleIndex:t},2,3)}}}let t=Array.isArray(e.per_angle)?e.per_angle:[];t.length>0&&t.forEach((e,a)=>{let t=aI.current.find(e=>"angle_variant"===e.type&&Number((e.data||{}).angleIndex)===a);if(t){if(Array.isArray(e.headlines)&&e.headlines.length>0&&!aI.current.find(e=>"headlines_out"===e.type&&(e.data||{}).angleId===t.id)){let a=aM("headlines_out",t,{headlines:e.headlines.slice(0,8),angleId:t.id},0,1),s=aI.current.find(e=>"meta_ad"===e.type&&(e.data||{}).angleId===t.id)||aE("meta_ad",a,{angleId:t.id},{x:a.x+300,y:a.y+300});aO(a,s)}if(Array.isArray(e.primaries)&&e.primaries.length>0&&!aI.current.find(e=>"copies_out"===e.type&&(e.data||{}).angleId===t.id)){let a=aM("copies_out",t,{primaries:e.primaries.slice(0,2),angleId:t.id},0,1),s=aI.current.find(e=>"meta_ad"===e.type&&(e.data||{}).angleId===t.id)||aE("meta_ad",a,{angleId:t.id},{x:a.x+300,y:a.y+300});aO(a,s)}if(Array.isArray(e.images)&&e.images.length>0&&!aI.current.find(e=>"images_out"===e.type&&(e.data||{}).angleId===t.id)){let a=aM("images_out",t,{images:e.images.slice(0,4),angleId:t.id},0,1),s=aI.current.find(e=>"meta_ad"===e.type&&(e.data||{}).angleId===t.id)||aE("meta_ad",a,{angleId:t.id},{x:a.x+300,y:a.y+300});aO(a,s)}}})}(a)}catch(e){}try{let e=Array.isArray(null==a?void 0:a.steps)?a.steps:[],t=e.filter(e=>(null==e?void 0:e.status)==="running"),s=t.length>0?t[t.length-1]:e.length>0?e[e.length-1]:null;a_(s||null)}catch(e){}}catch(e){}e||setTimeout(a,8e3)},t=setTimeout(a,3e3);return()=>{e=!0,clearTimeout(t)}},[eH]);let[eK,eQ]=(0,i.useState)("You are a marketing strategist, professional performance marketer, and market researcher. Using PRODUCT_INFO, generate exactly 3 distinct, high-converting angles for paid ads. Each angle must include: name (concise), big_idea (1 sentence), promise (benefit-focused), 6-10 headlines (≤12 words, specific, no emojis/ALL CAPS), and primaries with 2 variants: short (≤60 chars) and medium (≤120 chars). Avoid fluff; be concrete and conversion-oriented.\n\nReturn ONE valid json object ONLY with fields: angles[3] each with { name, big_idea, promise, headlines[6..10], primaries { short, medium } }."),[e$,e0]=(0,i.useState)('You are a senior direct‑response copywriter and conversion strategist. Using PRODUCT_INFO and ANGLE, write 8 unique, high‑converting ad headlines for Meta in three languages: English ("en"), Arabic Modern Standard ("ar"), and French ("fr"). Rules: ≤12 words each, concrete, specific, benefit‑led, no emojis, minimal punctuation, avoid spammy claims, no ALL CAPS.\n\nReturn ONE valid JSON object ONLY:\n{ "angles": [ { "headlines": { "en": ["h1","h2","h3","h4","h5","h6","h7","h8"], "ar": ["h1","h2","h3","h4","h5","h6","h7","h8"], "fr": ["h1","h2","h3","h4","h5","h6","h7","h8"] } } ] }'),[e1,e2]=(0,i.useState)('You are a senior direct‑response copywriter. Using PRODUCT_INFO and ANGLE, write 2 persuasive Meta primary texts per language that are multi‑line, include tasteful and relevant emojis, and maximize conversion with clear value, social proof (if implied), and a strong CTA. Each copy can be 2–4 short lines with line breaks. Provide English ("en"), Arabic Modern Standard ("ar"), and French ("fr").\n\nReturn ONE valid JSON object ONLY:\n{ "angles": [ { "primaries": { "en": ["...multi\nline\nA...", "...multi\nline\nB..."], "ar": ["...A AR...", "...B AR..."], "fr": ["...A FR...", "...B FR..."] } } ] }'),[e5,e3]=(0,i.useState)("Create a high‑quality ad image from this product photo. No text, premium look."),[e4,e6]=(0,i.useState)("You are a senior direct-response marketer. Analyze the landing page HTML to extract: title, benefits, pain_points, offers, emotions, and propose 3-5 marketing angles with headlines and primary texts. Respond only as compact JSON. Avoid prose."),[e8,e7]=(0,i.useState)(""),[e9,ae]=(0,i.useState)([]),[aa,at]=(0,i.useState)([]),[as,ai]=(0,i.useState)([]),[al,an]=(0,i.useState)([]);function ar(e){let a=Date.now();"angles"===e&&ae(e=>{var t;return[{version:((null===(t=e[0])||void 0===t?void 0:t.version)||0)+1,text:eK,savedAt:a},...e]}),"headlines"===e&&at(e=>{var t;return[{version:((null===(t=e[0])||void 0===t?void 0:t.version)||0)+1,text:e$,savedAt:a},...e]}),"copies"===e&&ai(e=>{var t;return[{version:((null===(t=e[0])||void 0===t?void 0:t.version)||0)+1,text:e1,savedAt:a},...e]}),"gemini"===e&&an(e=>{var t;return[{version:((null===(t=e[0])||void 0===t?void 0:t.version)||0)+1,text:e5,savedAt:a},...e]})}function ad(e,a){if("angles"===e){let e=e9.find(e=>e.version===a);e&&eQ(e.text)}if("headlines"===e){let e=aa.find(e=>e.version===a);e&&e0(e.text)}if("copies"===e){let e=as.find(e=>e.version===a);e&&e2(e.text)}if("gemini"===e){let e=al.find(e=>e.version===a);e&&e3(e.text)}}(0,i.useEffect)(()=>{!function(){try{let e=localStorage.getItem("ptos_versions_angles");e&&ae(JSON.parse(e))}catch(e){}try{let e=localStorage.getItem("ptos_versions_headlines");e&&at(JSON.parse(e))}catch(e){}try{let e=localStorage.getItem("ptos_versions_copies");e&&ai(JSON.parse(e))}catch(e){}try{let e=localStorage.getItem("ptos_versions_gemini");e&&an(JSON.parse(e))}catch(e){}}()},[]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_versions_angles",JSON.stringify(e9||[]))}catch(e){}},[e9]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_versions_headlines",JSON.stringify(aa||[]))}catch(e){}},[aa]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_versions_copies",JSON.stringify(as||[]))}catch(e){}},[as]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_versions_gemini",JSON.stringify(al||[]))}catch(e){}},[al]);let[ao,ac]=(0,i.useState)("inputs"),[ap,am]=(0,i.useState)(1),[au,ah]=(0,i.useState)({x:0,y:0}),ax=(0,i.useRef)(null),[ag,av]=(0,i.useState)(null),af=(0,i.useRef)(null),ay=(0,i.useRef)(null),[aj,a_]=(0,i.useState)(null);async function aN(){try{if(!G){alert("Enter landing page URL first.");return}eF(!0);let e=await (0,c.HX)({url:G,prompt:e4,model:eR});if(null==e?void 0:e.error)throw Error(e.error);"string"==typeof(null==e?void 0:e.prompt_used)&&e7(e.prompt_used),"string"!=typeof(null==e?void 0:e.title)||V&&V.trim()||(X(e.title),er(e=>({...e,title:"analyze_landing"})));let a=Array.isArray(null==e?void 0:e.benefits)?e.benefits:[];a.length>0&&(Z(a.join("\n")),er(e=>({...e,benefits:"analyze_landing"})));let t=Array.isArray(null==e?void 0:e.pain_points)?e.pain_points:[];t.length>0&&(K(t.join("\n")),er(e=>({...e,pains:"analyze_landing"})));let s=Array.isArray(null==e?void 0:e.offers)?e.offers:[];s.length>0&&($(s.join("\n")),er(e=>({...e,offers:"analyze_landing"})));let i=Array.isArray(null==e?void 0:e.emotions)?e.emotions:[];i.length>0&&!ej&&e_(i[0]);let l=((Array.isArray(null==e?void 0:e.images)?e.images:[])||[]).filter(e=>"string"==typeof e&&e),n=l.slice(1),r=n.length>0?n:l;r.length>0&&(el(r.slice(0,10)),et||(es(r[0]),er(e=>({...e,sourceImage:"analyze_landing"}))));let d=Array.isArray(null==e?void 0:e.angles)?e.angles:[];d.length>0&&(eu(d),ex(0)),alert("Analyzed landing page with AI. Prefilled inputs.")}catch(e){alert("Analyze failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}(0,i.useEffect)(()=>{try{let i=sessionStorage.getItem("ptos_last_test_id");if(!i)return;let l=sessionStorage.getItem("flow_cache_".concat(i));if(l){var e,a,t,s;let i=JSON.parse(l||"{}");"string"==typeof(null==i?void 0:null===(e=i.settings)||void 0===e?void 0:e.saved_audience_id)&&eU(i.settings.saved_audience_id),Array.isArray(null==i?void 0:null===(a=i.settings)||void 0===a?void 0:a.countries)&&ez((i.settings.countries||[]).join(",")),"boolean"==typeof(null==i?void 0:null===(t=i.settings)||void 0===t?void 0:t.advantage_plus)&&eO(!!i.settings.advantage_plus),"string"==typeof(null==i?void 0:null===(s=i.settings)||void 0===s?void 0:s.model)&&eM(i.settings.model)}}catch(e){}},[]),(0,i.useEffect)(()=>{try{if(!e4){let e=localStorage.getItem("ptos_analyze_prompt_default");e&&e6(e)}}catch(e){}},[e4]),(0,i.useEffect)(()=>{try{let e=localStorage.getItem("ptos_ads_headlines_prompt");e&&e0(e)}catch(e){}try{let e=localStorage.getItem("ptos_ads_copies_prompt");e&&e2(e)}catch(e){}try{let e=localStorage.getItem("ptos_ads_gemini_prompt");e&&e3(e)}catch(e){}},[]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_ads_headlines_prompt",e$)}catch(e){}},[e$]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_ads_copies_prompt",e1)}catch(e){}},[e1]),(0,i.useEffect)(()=>{try{localStorage.setItem("ptos_ads_gemini_prompt",e5)}catch(e){}},[e5]),(0,i.useEffect)(()=>{try{sessionStorage.removeItem("ptos_transfer_landing")}catch(e){}},[]),(0,i.useEffect)(()=>{!eN&&eg.length>0&&eb(eg[0])},[eg,eN]);let ab=(0,i.useRef)(1),aA=()=>"a".concat(ab.current++),[aw,aS]=(0,i.useState)(()=>[{id:aA(),type:"landing",x:120,y:160,data:{url:"",image:"",title:""}}]),[ak,aC]=(0,i.useState)([]),aI=(0,i.useRef)([]);function aE(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,i={id:aA(),type:e,x:s?s.x:a.x+300,y:s?s.y:a.y,data:t};return aS(e=>[...e,i]),i}function aO(e,a){aC(t=>t.some(t=>t.from===e.id&&t.to===a.id)?t:[...t,{id:aA(),from:e.id,fromPort:"out",to:a.id,toPort:"in"}])}function aR(){let e=aw.find(e=>"landing"===e.type)||aw[0],a=aw.find(e=>"angles"===e.type);if(a){av(a.id);return}let t=aE("angles",e,{},{x:e.x+300,y:e.y});aO(e,t),av(t.id)}function aM(e,a,t,s,i){let l=function(e){let a={...e},t=0;for(;function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{w:220,h:160};return aw.some(t=>{let s={x:e.x,y:e.y,w:a.w,h:a.h},i={x:t.x,y:t.y,w:220,h:160};return!(s.x+s.w<i.x||i.x+i.w<s.x||s.y+s.h<i.y||i.y+i.h<s.y)})}(a)&&t<50;)a.y+=200,t++;return a}({x:a.x+300,y:Math.round(a.y+(s-(i-1)/2)*180)}),n=aE(e,a,t,l);return aO(a,n),n}async function aP(e){try{var a,t,s;let i=aw.find(a=>a.id===e&&"headlines"===a.type);if(!i)return;aS(a=>a.map(a=>a.id===e?{...a,data:{...a.data,status:"running"}}:a)),eF(!0);let l=Date.now(),n=W.split("\n").map(e=>e.trim()).filter(Boolean),r=q.split("\n").map(e=>e.trim()).filter(Boolean),d=null===(a=i.data)||void 0===a?void 0:a.angle,o={audience:H,benefits:n,pain_points:r,title:V},p=aJ(e$),m=d?"".concat(p,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(o),"\nANGLE: ").concat(JSON.stringify(d)):"".concat(p,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(o)),u=await (0,c.PN)({product:o,num_angles:1,prompt:m||void 0,model:eR}),h=(Array.isArray(null==u?void 0:u.angles)?u.angles:[])[0]||{},x=[],g=[],v=[];try{Array.isArray(h.headlines_en)&&(x=h.headlines_en),Array.isArray(h.headlines_fr)&&(g=h.headlines_fr),Array.isArray(h.headlines_ar)&&(v=h.headlines_ar);let e=h.headlines;x.length&&g.length&&v.length||(e&&"object"==typeof e?(!x.length&&Array.isArray(e.en)&&(x=e.en),!g.length&&Array.isArray(e.fr)&&(g=e.fr),!v.length&&Array.isArray(e.ar)&&(v=e.ar)):!Array.isArray(h.headlines)||x.length||(x=h.headlines))}catch(e){}let f=aM("headlines_out",i,{headlines_en:(x||[]).slice(0,8),headlines_fr:(g||[]).slice(0,8),headlines_ar:(v||[]).slice(0,8),headlines:(x||[]).slice(0,8),angleId:(null===(t=i.data)||void 0===t?void 0:t.angleId)||i.id},0,1),y=String((null===(s=i.data)||void 0===s?void 0:s.angleId)||i.id),j=aw.find(e=>{var a;return"meta_ad"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===y});j&&aO(f,j);let _=Date.now();aS(a=>a.map(a=>{var t;return a.id===e?{...a,data:{...a.data,status:"done",meta:{...(null===(t=a.data)||void 0===t?void 0:t.meta)||{},lastRun:{nodeType:"headlines",startedAt:l,finishedAt:_,durationMs:_-l,model:"default (server)",promptUsed:m,inputSnapshot:{audience:H,benefits:n,pain_points:r,title:V,angle:d},inputSources:en,outputSnapshot:{headlines_en:(x||[]).slice(0,8),headlines_fr:(g||[]).slice(0,8),headlines_ar:(v||[]).slice(0,8)},logs:[]}}}}:a}))}catch(e){alert("Generate failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}async function az(e){try{var a,t,s,i,l,n;let r=aw.find(a=>a.id===e&&"copies"===a.type);if(!r)return;aS(a=>a.map(a=>a.id===e?{...a,data:{...a.data,status:"running"}}:a)),eF(!0);let d=Date.now(),o=W.split("\n").map(e=>e.trim()).filter(Boolean),p=q.split("\n").map(e=>e.trim()).filter(Boolean),m=null===(a=r.data)||void 0===a?void 0:a.angle,u={audience:H,benefits:o,pain_points:p,title:V},h=aJ(e1),x=m?"".concat(h,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(u),"\nANGLE: ").concat(JSON.stringify(m)):"".concat(h,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(u)),g=await (0,c.PN)({product:u,num_angles:1,prompt:x||void 0,model:eR}),v=(Array.isArray(null==g?void 0:g.angles)?g.angles:[])[0]||{},f=[];try{let e=v.primaries;Array.isArray(e)?f=e:e&&"object"==typeof e&&(f=[e.short,e.medium,e.long].filter(e=>"string"==typeof e&&e))}catch(e){}let y=[],j=[],_=[];try{Array.isArray(v.primaries_en)&&(y=v.primaries_en),Array.isArray(v.primaries_fr)&&(j=v.primaries_fr),Array.isArray(v.primaries_ar)&&(_=v.primaries_ar);let e=v.primaries;e&&"object"==typeof e&&!Array.isArray(e)&&(!y.length&&Array.isArray(e.en)&&(y=e.en),!j.length&&Array.isArray(e.fr)&&(j=e.fr),!_.length&&Array.isArray(e.ar)&&(_=e.ar)),!y.length&&Array.isArray(v.primaries)&&(y=v.primaries),y.length||(y=f)}catch(e){}let N=aM("copies_out",r,{primaries_en:(y||[]).slice(0,2),primaries_fr:(j||[]).slice(0,2),primaries_ar:(_||[]).slice(0,2),primaries:(y||[]).slice(0,2),angleId:(null===(t=r.data)||void 0===t?void 0:t.angleId)||r.id},0,1),b=(l=String((null===(s=r.data)||void 0===s?void 0:s.angleId)||r.id),n=r,aw.find(e=>{var a;return"meta_ad"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===l})||aE("meta_ad",n,{angleId:l},{x:n.x+300,y:n.y+300}));aO(N,b);let A=String((null===(i=r.data)||void 0===i?void 0:i.angleId)||r.id);for(let e of aw.filter(e=>{var a;return("headlines_out"===e.type||"images_out"===e.type)&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===A}))aO(e,b);let w=Date.now();aS(a=>a.map(a=>{var t;return a.id===e?{...a,data:{...a.data,status:"done",meta:{...(null===(t=a.data)||void 0===t?void 0:t.meta)||{},lastRun:{nodeType:"copies",startedAt:d,finishedAt:w,durationMs:w-d,model:"default (server)",promptUsed:x,inputSnapshot:{audience:H,benefits:o,pain_points:p,title:V,angle:m},inputSources:en,outputSnapshot:{primaries_en:(y||[]).slice(0,2),primaries_fr:(j||[]).slice(0,2),primaries_ar:(_||[]).slice(0,2)},logs:[]}}}}:a}))}catch(e){alert("Generate failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}async function aL(e){try{var a,t,s,i;let l=aw.find(a=>a.id===e&&"gemini_images"===a.type);if(!l)return;aS(a=>a.map(a=>a.id===e?{...a,data:{...a.data,status:"running"}}:a));let n=(null===(a=l.data)||void 0===a?void 0:a.from)||et||ei[1]||ei[0];if(!n){alert("Missing source image URL");return}eF(!0);let r=Date.now(),d=(Q||"").trim(),o=null===(t=l.data)||void 0===t?void 0:t.angle,p=o&&o.name?" Angle: ".concat(String(o.name)):"",m=aJ(e5||"Create a high‑quality ad image from this product photo. No text, premium look."),u="".concat(m).concat(d?" Emphasize the offer/promotion: ".concat(d,"."):"").concat(p),h=await (0,c.oB)({image_url:n,prompt:u,num_images:4,neutral_background:!0}),x=[];try{let e=h||{};Array.isArray(e.images)?x=e.images:Array.isArray(e.urls)?x=e.urls:Array.isArray(e.items)&&(x=e.items.map(e=>(null==e?void 0:e.image)||(null==e?void 0:e.url)).filter(e=>"string"==typeof e&&e))}catch(e){}ev(x);let g=aM("images_out",l,{images:x.slice(0,4),angleId:(null===(s=l.data)||void 0===s?void 0:s.angleId)||l.id},0,1),v=String((null===(i=l.data)||void 0===i?void 0:i.angleId)||l.id),f=aw.find(e=>{var a;return"meta_ad"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.angleId)===v});f&&aO(g,f);let y=Date.now();aS(a=>a.map(a=>{var t;return a.id===e?{...a,data:{...a.data,status:"done",meta:{...(null===(t=a.data)||void 0===t?void 0:t.meta)||{},lastRun:{nodeType:"gemini_images",startedAt:r,finishedAt:y,durationMs:y-r,model:"Gemini (server default)",promptUsed:u,inputSnapshot:{image_url:n,offers:d,angle:o},inputSources:en,outputSnapshot:{images:x.slice(0,4)},logs:[]}}}}:a}))}catch(e){alert("Image gen failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}async function aU(){try{eF(!0);let e=Date.now(),a={audience:H,benefits:W.split("\n").map(e=>e.trim()).filter(Boolean),pain_points:q.split("\n").map(e=>e.trim()).filter(Boolean),title:V||void 0},t=await (0,c.PN)({product:a,num_angles:3,prompt:eK||void 0,model:eR}),s=Array.isArray(null==t?void 0:t.angles)?t.angles:[];eu(s);let i=aw.find(e=>"landing"===e.type)||aw[0],l=aw.find(e=>"angles"===e.type)||aE("angles",i,{},{x:i.x+300,y:i.y});aO(i,l);let n=Math.min(3,Math.max(0,s.length||3));for(let e=0;e<n;e++){let a=s[e]||{name:"Angle ".concat(e+1)};aM("angle_variant",l,{angle:a,angleIndex:e},e,n)}let r=Date.now();aS(t=>t.map(t=>{var i;return t.id===l.id?{...t,data:{...t.data,meta:{...(null===(i=t.data)||void 0===i?void 0:i.meta)||{},lastRun:{nodeType:"angles",startedAt:e,finishedAt:r,durationMs:r-e,model:"default (server)",promptUsed:eK,inputSnapshot:a,inputSources:en,outputSnapshot:{angles:s.slice(0,3)},logs:[]}}}}:t}))}catch(e){alert("Angles generation failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}async function aD(e){let a=aw.find(a=>a.id===e);if(!a)return;let t=(a.data||{}).angle||{},s=a.id;aM("headlines",a,{angle:t,angleId:s,angleIndex:(a.data||{}).angleIndex},0,3),aM("copies",a,{angle:t,angleId:s,angleIndex:(a.data||{}).angleIndex},1,3),aM("gemini_images",a,{from:et||ei[0]||"",angle:t,angleId:s,angleIndex:(a.data||{}).angleIndex},2,3)}async function aB(){try{var e,a,t,s;if(!et){alert("Missing source image URL");return}eF(!0);let i=(Q||"").trim(),l=aJ(e5||"Create a high‑quality ad image from this product photo. No text, premium look."),n="".concat(l).concat(i?" Emphasize the offer/promotion: ".concat(i,"."):""),r=await (0,c.oB)({image_url:et,prompt:n,num_images:4,neutral_background:!0}),d=[];try{let e=r||{};Array.isArray(e.images)?d=e.images:Array.isArray(e.urls)?d=e.urls:Array.isArray(e.items)&&(d=e.items.map(e=>(null==e?void 0:e.image)||(null==e?void 0:e.url)).filter(e=>"string"==typeof e&&e))}catch(e){}ev(d);let o=aw.find(e=>"landing"===e.type)||aw[0],p=(e="gemini_images",a=o,t=0,s=0,aw.find(a=>a.type===e)||aM(e,a,{},2,3)),m=aM("images_out",p,{images:d},0,1),u=aw.find(e=>"meta_ad"===e.type)||aE("meta_ad",p,{},{x:p.x+300,y:p.y+300});aO(m,u)}catch(e){alert("Image gen failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}async function aT(){try{let e;if(!G||!ef||!ej){alert("Select headline, primary text, and landing URL.");return}try{let e=new URL(G);if(!("http:"===e.protocol||"https:"===e.protocol))throw Error("Invalid scheme")}catch(e){alert("Landing URL must be a valid http(s) URL.");return}let a=Array.from(new Set(eA.filter(e=>"string"==typeof e&&e)));if(a.length>=2)for(let e of a)try{let a=new URL(e);if(!("http:"===a.protocol||"https:"===a.protocol))throw Error("Invalid scheme")}catch(e){alert("All selected carousel image URLs must be valid http(s).");return}else{if(!eN){alert("Select an image or choose 2+ images for carousel.");return}try{let e=new URL(eN);if(!("http:"===e.protocol||"https:"===e.protocol))throw Error("Invalid scheme")}catch(e){alert("Image URL must be a valid public http(s) URL.");return}}eF(!0);let t={};if(!eE&&(eL?t.saved_audience_id=eL:eP&&(t.targeting={geo_locations:{countries:eP.split(",").map(e=>e.trim().toUpperCase()).filter(Boolean)}})),a.length>=2){let s=a.map(e=>({image_url:e,headline:ef,description:"",link:G,call_to_action:eS})),i={primary_text:ej,landing_url:G,cards:s,call_to_action:eS,adset_budget:eC,title:ef,...t.saved_audience_id?{saved_audience_id:t.saved_audience_id}:{},...t.targeting?{targeting:t.targeting}:{}};e=await (0,c.sj)(i)}else{let a={headline:ef,primary_text:ej,description:"",image_url:eN,landing_url:G,call_to_action:eS,adset_budget:eC,title:ef,...t.saved_audience_id?{saved_audience_id:t.saved_audience_id}:{},...t.targeting?{targeting:t.targeting}:{}};e=await (0,c.dP)(a)}if(null==e?void 0:e.error)throw Error(e.error);alert("Meta draft created successfully.")}catch(e){alert("Meta draft failed: "+String((null==e?void 0:e.message)||e))}finally{eF(!1)}}(0,i.useEffect)(()=>{aI.current=aw},[aw]),(0,i.useEffect)(()=>{aS(e=>e.map(e=>"landing"===e.type?{...e,data:{...e.data,url:G,image:G&&(ei||[])[0]?(ei||[])[0]:e.data.image,title:V}}:e))},[G,ei,V]),(0,i.useEffect)(()=>{let e;if(T)return e&&clearTimeout(e),e=setTimeout(async()=>{try{let e={audience:H,benefits:W.split("\n").filter(Boolean),pain_points:q.split("\n").filter(Boolean),title:V||void 0};await (0,c.XD)(T,{product:e,ads:{selectedHeadline:ef,selectedPrimary:ej,selectedImage:eN,cta:eS,budget:eC,advantagePlus:eE,countries:eP,savedAudienceId:eL,candidateImages:ei,adImages:eg},prompts:{analyze_landing_prompt:e4,headlines_prompt:e$,copies_prompt:e1,gemini_ad_prompt:e5},ui:{zoom:ap,pan:au,selected_node:ag,active_left_tab:ao},flow:{nodes:aw,edges:ak}});try{localStorage.setItem("ptos_analyze_prompt_default",e4)}catch(e){}}catch(e){}},800),()=>{e&&clearTimeout(e)}},[T,ef,ej,eN,eS,eC,eE,eP,eL,ei,eg,H,W,q,V,e4,e$,e1,e5,aw,ak,ap,au,ag,ao,eR]);let aF=em[eh]||null;(0,i.useMemo)(()=>{let e=null==aF?void 0:aF.headlines;return Array.isArray(e)?e:e&&"object"==typeof e&&Array.isArray(e.en)?e.en:[]},[aF]),(0,i.useMemo)(()=>{let e=null==aF?void 0:aF.primaries;if(Array.isArray(e))return e;if(e&&"object"==typeof e){if(Array.isArray(e.en))return e.en;let a=[e.short,e.medium,e.long].filter(e=>"string"==typeof e&&e);if(a.length)return a}return[]},[aF]);let aG=(0,i.useMemo)(()=>aw.find(e=>e.id===ag)||null,[aw,ag]);function aJ(e){let a=W.split("\n").map(e=>e.trim()).filter(Boolean),t=q.split("\n").map(e=>e.trim()).filter(Boolean);return String(e||"").replaceAll("{audience}",H||"").replaceAll("{benefits}",JSON.stringify(a)).replaceAll("{pain_points}",JSON.stringify(t)).replaceAll("{title}",V||"").replaceAll("{offers}",Q||"").replaceAll("{emotions}",ee||"")}return(0,s.jsxs)("div",{className:"min-h-screen w-full bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-sky-50 via-white to-indigo-50 text-slate-800",children:[(0,s.jsxs)("header",{className:"h-16 px-4 md:px-6 flex items-center justify-between border-b bg-white/70 backdrop-blur sticky top-0 z-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(r.Z,{className:"w-6 h-6 text-blue-600"}),(0,s.jsx)("h1",{className:"font-semibold text-lg",children:"Product Testing OS"}),(0,s.jsxs)("nav",{className:"ml-4 flex items-center gap-1 text-sm",children:[(0,s.jsx)(n.default,{href:"/studio/",className:"px-3 py-1.5 rounded hover:bg-slate-100",children:"Create Product"}),(0,s.jsx)("span",{className:"px-3 py-1.5 rounded bg-blue-600 text-white",children:"Create Ads"}),(0,s.jsx)(n.default,{href:"/promotion/",className:"px-3 py-1.5 rounded hover:bg-slate-100",children:"Create Promotion"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,s.jsx)(n.default,{href:"/",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:"Home"}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:eG,onChange:async e=>{let a=e.target.checked;eJ(a),a&&await eZ()}}),(0,s.jsx)("span",{children:"Auto-run"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-3 p-3 h-[calc(100vh-4rem)]",children:[(0,s.jsxs)("aside",{className:"col-span-12 md:col-span-3 space-y-3 overflow-y-auto pb-24",children:[(0,s.jsxs)(u,{children:[(0,s.jsx)(h,{className:"pb-2",children:(0,s.jsx)(x,{className:"text-base",children:"LLM model"})}),(0,s.jsx)(g,{children:(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:eR,onChange:e=>eM(e.target.value),className:"w-full rounded-xl border px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"gpt-4o-mini",children:"gpt-4o-mini"}),(0,s.jsx)("option",{value:"gpt-4.1",children:"gpt-4.1"}),(0,s.jsx)("option",{value:"gpt-4a",children:"chatgpt-4a"}),(0,s.jsx)("option",{value:"gpt-5",children:"gpt-5"})]})})})]}),(0,s.jsx)(u,{children:(0,s.jsx)(h,{className:"pb-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"text-sm px-3 py-1.5 rounded ".concat("inputs"===ao?"bg-blue-600 text-white":"border"),onClick:()=>ac("inputs"),children:"Inputs"}),(0,s.jsx)("button",{className:"text-sm px-3 py-1.5 rounded ".concat("prompts"===ao?"bg-blue-600 text-white":"border"),onClick:()=>ac("prompts"),children:"Prompts"})]})})}),aG&&(0,s.jsxs)(u,{children:[(0,s.jsx)(h,{className:"pb-2",children:(0,s.jsx)(x,{className:"text-base",children:"Selected Card Details"})}),(0,s.jsxs)(g,{className:"space-y-2 text-xs",children:["angle_variant"===aG.type&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Angle"}),(0,s.jsx)("div",{className:"font-medium",children:String((null===(a=aG.data)||void 0===a?void 0:null===(e=a.angle)||void 0===e?void 0:e.name)||"")}),(0,s.jsxs)("div",{children:["Big idea: ",String((null===(j=aG.data)||void 0===j?void 0:null===(t=j.angle)||void 0===t?void 0:t.big_idea)||"")]}),(0,s.jsxs)("div",{children:["Promise: ",String((null===(A=aG.data)||void 0===A?void 0:null===(b=A.angle)||void 0===b?void 0:b.promise)||"")]}),(()=>{var e,a;let t=null===(a=aG.data)||void 0===a?void 0:null===(e=a.angle)||void 0===e?void 0:e.headlines,s=Array.isArray(t)?t:t&&"object"==typeof t&&Array.isArray(t.en)?t.en:[];return Array.isArray(s)&&s.length>0})()&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Headlines"}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:(()=>{var e,a;let t=null===(a=aG.data)||void 0===a?void 0:null===(e=a.angle)||void 0===e?void 0:e.headlines;return(Array.isArray(t)?t:t&&"object"==typeof t&&Array.isArray(t.en)?t.en:[]).slice(0,8)})().map((e,a)=>(0,s.jsx)("li",{children:e},a))})]}),(()=>{var e;let a=aw.find(e=>"angles"===e.type),t=((null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.meta)||{}).lastRun;return t?(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Generated by"}),(0,s.jsxs)("div",{children:["Model: ",t.model||"default"]}),(0,s.jsxs)("div",{children:["Duration: ",t.durationMs," ms"]}),(0,s.jsx)("div",{children:"Prompt used:"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:t.promptUsed||""})]}):null})()]}),"headlines"===aG.type&&(()=>{var e,a,t;let i=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun,l=W.split("\n").map(e=>e.trim()).filter(Boolean),n=q.split("\n").map(e=>e.trim()).filter(Boolean),r={audience:H,benefits:l,pain_points:n,title:V},d=aJ(e$),o=null===(a=aG.data)||void 0===a?void 0:a.angle,c=o?"".concat(d,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(r),"\nANGLE: ").concat(JSON.stringify(o)):"".concat(d,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(r));return(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Prompt"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:e$}),(0,s.jsx)("div",{className:"text-slate-500",children:"Expanded preview"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:d}),(0,s.jsx)("div",{className:"text-slate-500",children:"Variables used"}),(0,s.jsxs)("div",{className:"text-xs grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Audience:"})," ",H||"-"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Title:"})," ",V||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Benefits:"})," ",l.join(" | ")||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Pain points:"})," ",n.join(" | ")||"-"]})]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Exact prompt next run"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:c}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Last output"}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:((null===(t=i.outputSnapshot)||void 0===t?void 0:t.headlines_en)||[]).map((e,a)=>(0,s.jsx)("li",{children:e},a))})]})]})})(),"headlines_out"===aG.type&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Headlines"}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:(Array.isArray(null===(w=aG.data)||void 0===w?void 0:w.headlines_en)?aG.data.headlines_en:(null===(S=aG.data)||void 0===S?void 0:S.headlines)||[]).slice(0,12).map((e,a)=>(0,s.jsx)("li",{children:e},a))})]}),"copies"===aG.type&&(()=>{var e,a,t;let i=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun,l=W.split("\n").map(e=>e.trim()).filter(Boolean),n=q.split("\n").map(e=>e.trim()).filter(Boolean),r={audience:H,benefits:l,pain_points:n,title:V},d=aJ(e1),o=null===(a=aG.data)||void 0===a?void 0:a.angle,c=o?"".concat(d,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(r),"\nANGLE: ").concat(JSON.stringify(o)):"".concat(d,"\n\nPRODUCT_INFO: ").concat(JSON.stringify(r));return(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Prompt"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:e1}),(0,s.jsx)("div",{className:"text-slate-500",children:"Expanded preview"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:d}),(0,s.jsx)("div",{className:"text-slate-500",children:"Variables used"}),(0,s.jsxs)("div",{className:"text-xs grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Audience:"})," ",H||"-"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Title:"})," ",V||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Benefits:"})," ",l.join(" | ")||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Pain points:"})," ",n.join(" | ")||"-"]})]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Exact prompt next run"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:c}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Last output"}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:((null===(t=i.outputSnapshot)||void 0===t?void 0:t.primaries_en)||[]).map((e,a)=>(0,s.jsx)("li",{children:(0,s.jsx)("span",{className:"whitespace-pre-line",children:e})},a))})]})]})})(),"copies_out"===aG.type&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Primary texts"}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:(Array.isArray(null===(k=aG.data)||void 0===k?void 0:k.primaries_en)?aG.data.primaries_en:(null===(C=aG.data)||void 0===C?void 0:C.primaries)||[]).slice(0,12).map((e,a)=>(0,s.jsx)("li",{children:(0,s.jsx)("span",{className:"whitespace-pre-line",children:e})},a))})]}),"gemini_images"===aG.type&&(()=>{var e,a,t,i;let l=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun;W.split("\n").map(e=>e.trim()).filter(Boolean),q.split("\n").map(e=>e.trim()).filter(Boolean);let n=aJ(e5),r=null===(a=aG.data)||void 0===a?void 0:a.angle,d=r&&r.name?" Angle: ".concat(String(r.name)):"",o="".concat(n).concat(Q?" Emphasize the offer/promotion: ".concat(Q,"."):"").concat(d);return(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Prompt"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:e5}),(0,s.jsx)("div",{className:"text-slate-500",children:"Expanded preview"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:n}),(0,s.jsx)("div",{className:"text-slate-500",children:"Variables used"}),(0,s.jsxs)("div",{className:"text-xs grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Offers:"})," ",Q||"-"]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Emotions:"})," ",ee||"-"]})]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Exact prompt next run"}),(0,s.jsx)("pre",{className:"bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-24 overflow-auto",children:o}),l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:["Source image: ",String((null===(t=l.inputSnapshot)||void 0===t?void 0:t.image_url)||"")]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Last images"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:((null===(i=l.outputSnapshot)||void 0===i?void 0:i.images)||[]).map((e,a)=>(0,s.jsx)("img",{src:eo(e),alt:"img-".concat(a),className:"w-full h-20 object-cover rounded border"},a))})]})]})})(),"images_out"===aG.type&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Images"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:((null===(I=aG.data)||void 0===I?void 0:I.images)||[]).slice(0,8).map((e,a)=>(0,s.jsx)("img",{src:eo(e),alt:"img-".concat(a),className:"w-full h-20 object-cover rounded border"},a))})]})]})]}),"inputs"===ao&&(0,s.jsxs)(u,{children:[(0,s.jsx)(h,{className:"pb-2",children:(0,s.jsxs)(x,{className:"text-base flex items-center gap-2",children:[(0,s.jsx)(d,{className:"w-4 h-4"}),"Ad inputs"]})}),(0,s.jsxs)(g,{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Landing page URL"}),(0,s.jsx)(v,{value:G,onChange:e=>J(e.target.value),placeholder:"https://yourstore.com/pages/offer"}),(0,s.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:aN,children:"Analyze"}),(0,s.jsx)(m,{size:"sm",onClick:aR,children:"Create Ad"})]}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Analyze prompt"}),(0,s.jsx)(f,{rows:4,value:e4,onChange:e=>e6(e.target.value)}),e8&&(0,s.jsxs)("div",{className:"text-[11px] text-slate-500 mt-1",children:["Prompt used (last): ",e8.slice(0,160),e8.length>160?"…":""]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Audience"}),(0,s.jsx)(v,{value:H,onChange:e=>{Y(e.target.value),er(e=>({...e,audience:"manual"}))},placeholder:"Shoppers likely to buy this product"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Product title"}),(0,s.jsx)(v,{value:V,onChange:e=>{X(e.target.value),er(e=>({...e,title:"manual"}))},placeholder:"Product title"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Key benefits (one per line)"}),(0,s.jsx)(f,{rows:3,value:W,onChange:e=>{Z(e.target.value),er(e=>({...e,benefits:"manual"}))}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Pain points (one per line)"}),(0,s.jsx)(f,{rows:3,value:q,onChange:e=>{K(e.target.value),er(e=>({...e,pains:"manual"}))}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Offers / Promotions"}),(0,s.jsx)(f,{rows:2,value:Q,onChange:e=>{$(e.target.value),er(e=>({...e,offers:"manual"}))},placeholder:"E.g., -20%, Free shipping, Bundle"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Emotional triggers"}),(0,s.jsx)(f,{rows:2,value:ee,onChange:e=>{ea(e.target.value),er(e=>({...e,emotions:"manual"}))},placeholder:"Trust, novelty, safety, time-saving"})]}),(0,s.jsx)(y,{}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Source image for ad"}),(0,s.jsx)(v,{value:et,onChange:e=>{es(e.target.value),er(e=>({...e,sourceImage:"manual"}))},placeholder:"https://cdn.shopify.com/...jpg"}),ei.length>0&&(0,s.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:ei.slice(0,9).map((e,a)=>(0,s.jsxs)("div",{className:"relative border rounded overflow-hidden ".concat(e===et?"ring-2 ring-blue-500":"ring-1 ring-slate-200"),children:[(0,s.jsx)("button",{className:"absolute top-1 right-1 z-10 bg-white/90 hover:bg-white text-slate-700 rounded px-1 text-xs",onClick:t=>{t.preventDefault(),t.stopPropagation(),el(e=>e.filter((e,t)=>t!==a)),et===e&&es("")},children:"Delete"}),(0,s.jsx)("button",{className:"block w-full",onClick:()=>{es(e),er(e=>({...e,sourceImage:"manual"}))},children:(0,s.jsx)("img",{src:eo(e),alt:"img-".concat(a),className:"w-full h-20 object-cover"})})]},a))}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:async()=>{await aN()},children:"Analyze"})})]})]})]}),"prompts"===ao&&(0,s.jsxs)(u,{children:[(0,s.jsx)(h,{className:"pb-2",children:(0,s.jsx)(x,{className:"text-base",children:"Prompts"})}),(0,s.jsxs)(g,{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Angles prompt"}),(0,s.jsx)(f,{rows:4,value:eK,onChange:e=>eQ(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Headlines prompt"}),(0,s.jsx)(f,{rows:4,value:e$,onChange:e=>e0(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Ad copies prompt"}),(0,s.jsx)(f,{rows:4,value:e1,onChange:e=>e2(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Gemini ad image prompt"}),(0,s.jsx)(f,{rows:3,value:e5,onChange:e=>e3(e.target.value)})]})]})]})]}),(0,s.jsxs)("section",{className:"col-span-12 md:col-span-6 relative",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-2 py-1",children:[(0,s.jsx)("div",{className:"text-sm text-slate-500",children:"Flow canvas"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"text-xs text-slate-500",children:"Zoom"}),(0,s.jsx)("input",{type:"range",min:50,max:140,step:10,value:100*ap,onChange:e=>am(Number(e.target.value)/100),className:"w-40"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:aU,disabled:eT,children:"Generate angles"})]})]}),(0,s.jsx)(y,{className:"mb-2"}),(0,s.jsxs)("div",{ref:ax,className:"relative h-[calc(100%-3rem)] bg-white rounded-2xl shadow-inner overflow-auto border",onWheel:e=>{e.ctrlKey&&e.preventDefault()},onMouseDown:e=>{e.target.closest(".node-card")||(ay.current={startX:e.clientX,startY:e.clientY,panStartX:au.x,panStartY:au.y})},onMouseUp:()=>{af.current=null,ay.current=null},onMouseMove:e=>{if(af.current){let{id:a,startX:t,startY:s,nodeStartX:i,nodeStartY:l}=af.current,n=(e.clientX-t)/ap,r=(e.clientY-s)/ap;aS(e=>e.map(e=>e.id===a?{...e,x:Math.round(i+n),y:Math.round(l+r)}:e));return}if(ay.current){let{startX:a,startY:t,panStartX:s,panStartY:i}=ay.current;ah({x:s+(e.clientX-a),y:i+(e.clientY-t)})}},onContextMenu:e=>e.preventDefault(),children:[(0,s.jsx)(_,{}),(0,s.jsxs)("div",{className:"absolute left-0 top-0 origin-top-left",style:{transform:"translate(".concat(au.x,"px, ").concat(au.y,"px) scale(").concat(ap,")"),transformOrigin:"0 0",willChange:"transform"},children:[(0,s.jsx)("div",{className:"relative z-0",children:ak.map(e=>(0,s.jsx)(N,{edge:e,nodes:aw,active:function(e){if(!aj)return!1;let a=String(aj.step||"");if("generate_angles"===a){let a=aw.find(a=>a.id===e.from),t=aw.find(a=>a.id===e.to);return!!(a&&t&&"landing"===a.type&&"angles"===t.type)}let t=Number(aj.angle_index);if(Number.isNaN(t))return!1;let s=aw.find(a=>a.id===e.from),i=aw.find(a=>a.id===e.to);return!!s&&!!i&&"angle_variant"===s.type&&Number((s.data||{}).angleIndex)===t&&("generate_headlines"===a&&"headlines"===i.type||"generate_copies"===a&&"copies"===i.type||"generate_images"===a&&"gemini_images"===i.type)}(e)},e.id))}),(0,s.jsx)("div",{className:"relative z-10",children:aw.map(e=>{var a,t,i,l;return(0,s.jsxs)("div",{className:"node-card absolute select-none ".concat(ag===e.id?"ring-2 ring-blue-500":"ring-1 ring-slate-200"," rounded-2xl bg-white border shadow w-[220px]"),style:{left:e.x,top:e.y},onMouseDown:a=>{a.stopPropagation(),av(e.id),af.current={id:e.id,startX:a.clientX,startY:a.clientY,nodeStartX:e.x,nodeStartY:e.y}},children:[(0,s.jsxs)("div",{className:"px-3 py-2 flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-xs font-semibold text-slate-700",children:"landing"===e.type?"Landing Page":"angles"===e.type?"Generate Angles":"angle_variant"===e.type?"Angle: ".concat(String((null===(t=e.data)||void 0===t?void 0:null===(a=t.angle)||void 0===a?void 0:a.name)||"Variant")):"headlines"===e.type?"Generate Headlines":"copies"===e.type?"Generate Ad Copies":"gemini_images"===e.type?"Generate Ad Images":"headlines_out"===e.type?"Headlines Output":"copies_out"===e.type?"Ad Copies Output":"images_out"===e.type?"Images Output":"Review & Approve"}),(0,s.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-slate-100 text-slate-600",children:"idle"})]}),(0,s.jsx)(y,{}),(0,s.jsxs)("div",{className:"p-3 text-sm text-slate-700 min-h-[64px]",children:["landing"===e.type&&(0,s.jsxs)("div",{className:"text-xs text-slate-500 break-words truncate max-w-[220px]",children:[V?(0,s.jsx)("div",{className:"font-medium text-slate-700 truncate",children:V}):null,(0,s.jsx)("div",{className:"truncate",children:G||"No URL"})]}),"angles"===e.type&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Prepare angles prompt and generate 3 angle cards"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:aU,disabled:eT,children:"Generate angles"})]}),"angle_variant"===e.type&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Expand this angle into copies, headlines, and images"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>aD(e.id),disabled:eT,children:"Expand angle"})]}),"headlines"===e.type&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Prepare headlines prompt and generate outputs"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>aP(e.id),disabled:eT,children:"Generate headlines"})]}),"copies"===e.type&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Prepare ad copies prompt and generate outputs"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>az(e.id),disabled:eT,children:"Generate copies"})]}),"headlines_out"===e.type&&(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:[Array.isArray(null===(i=e.data)||void 0===i?void 0:i.headlines)?e.data.headlines.length:0," headlines"]}),"copies_out"===e.type&&(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:[Array.isArray(null===(l=e.data)||void 0===l?void 0:l.primaries)?e.data.primaries.length:0," copies"]}),"gemini_images"===e.type&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:[eg.length||0," images"]}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>aL(e.id),disabled:eT,children:"Generate images"})]}),"images_out"===e.type&&(0,s.jsxs)("div",{className:"text-xs text-slate-600",children:[eg.length||0," images generated"]}),"meta_ad"===e.type&&(0,s.jsx)("div",{className:"text-xs text-slate-600",children:"Review and approve to create draft in Meta"}),"landing"===e.type&&ei[0]&&(0,s.jsx)("img",{src:eo(ei[0]),alt:"cover",className:"mt-2 w-[180px] h-24 object-cover rounded"})]}),(0,s.jsx)("div",{className:"absolute w-2 h-2 rounded-full bg-slate-300 border border-slate-400",style:{left:-8,top:96}}),(0,s.jsx)("div",{className:"absolute w-2 h-2 rounded-full bg-slate-300 border border-slate-400",style:{right:-8,top:96}})]},e.id)})})]})]})]}),(0,s.jsx)("aside",{className:"col-span-12 md:col-span-3 space-y-3 overflow-y-auto pb-24",children:(0,s.jsxs)(u,{children:[(0,s.jsxs)(h,{className:"pb-2 flex items-center justify-between",children:[(0,s.jsx)(x,{className:"text-base",children:"Inspector"}),aG&&(0,s.jsx)("button",{className:"p-1 rounded hover:bg-slate-50",onClick:()=>aS(e=>e.filter(e=>e.id!==aG.id)),children:(0,s.jsx)(o.Z,{className:"w-4 h-4 text-slate-500"})})]}),(0,s.jsxs)(g,{children:[!aG&&(0,s.jsx)("div",{className:"text-sm text-slate-500",children:"Select a node to see details."}),aG&&(0,s.jsxs)("div",{className:"space-y-3 text-sm",children:["landing"===aG.type&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Landing page URL"}),(0,s.jsx)(v,{value:G,onChange:e=>J(e.target.value),placeholder:"https://yourstore.com/pages/offer"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:aN,children:"Analyze"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Title"}),(0,s.jsx)(v,{value:V,onChange:e=>{X(e.target.value),er(e=>({...e,title:"manual"}))},placeholder:"Product title"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Images"}),ei.length>0?(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2",children:ei.slice(0,9).map((e,a)=>(0,s.jsxs)("div",{className:"relative border rounded overflow-hidden ".concat(e===et?"ring-2 ring-blue-500":"ring-1 ring-slate-200"),children:[(0,s.jsx)("button",{className:"absolute top-1 right-1 z-10 bg-white/90 hover:bg-white text-slate-700 rounded px-1 text-xs",onClick:t=>{t.preventDefault(),el(e=>e.filter((e,t)=>t!==a)),et===e&&es("")},children:"Delete"}),(0,s.jsx)("button",{className:"block w-full",onClick:()=>{es(e),er(e=>({...e,sourceImage:"manual"}))},children:(0,s.jsx)("img",{src:e,alt:"img-".concat(a),className:"w-full h-16 object-cover"})})]},a))}):(0,s.jsx)("div",{className:"text-xs text-slate-500",children:"No images parsed yet."})]})]}),"angles"===aG.type&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Angles prompt"}),(0,s.jsx)(f,{rows:4,value:eK,onChange:e=>eQ(e.target.value)}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsxs)("select",{className:"text-xs border rounded px-2 py-1",onChange:e=>{let a=Number(e.target.value);Number.isNaN(a)||ad("angles",a)},defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"Versions…"}),e9.map(e=>(0,s.jsx)("option",{value:e.version,children:"v".concat(e.version," – ").concat(new Date(e.savedAt).toLocaleString())},e.version))]}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>ar("angles"),children:"Save version"})]})]}),(0,s.jsx)("div",{className:"text-[11px] text-slate-500 mt-1",children:"Preview:"}),(0,s.jsx)("pre",{className:"text-[11px] bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-32 overflow-auto",children:eK}),(0,s.jsx)("div",{className:"text-[11px] text-slate-500",children:"Inputs:"}),(0,s.jsxs)("ul",{className:"list-disc pl-4 text-xs",children:[(0,s.jsxs)("li",{children:["audience (",en.audience,"): ",H]}),(0,s.jsxs)("li",{children:["benefits (",en.benefits,"): ",W.split("\n").filter(Boolean).slice(0,4).join(", ")]}),(0,s.jsxs)("li",{children:["pain_points (",en.pains,"): ",q.split("\n").filter(Boolean).slice(0,4).join(", ")]}),(0,s.jsxs)("li",{children:["title (",en.title,"): ",V]})]}),(()=>{var e,a;let t=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun;return t?(0,s.jsxs)("div",{className:"text-xs space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Last run"}),(0,s.jsxs)("div",{children:["Model: ",t.model||"default"]}),(0,s.jsxs)("div",{children:["Duration: ",t.durationMs," ms"]}),(0,s.jsxs)("div",{children:["Started: ",new Date(t.startedAt).toLocaleString()]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Output angles:"}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:((null===(a=t.outputSnapshot)||void 0===a?void 0:a.angles)||[]).map((e,a)=>(0,s.jsx)("li",{children:String((null==e?void 0:e.name)||"Angle")},a))})]}):null})(),(0,s.jsx)("div",{children:(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:aU,disabled:eT,children:"Generate angles"})})]}),("headlines"===aG.type||"headlines_out"===aG.type)&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Headlines prompt"}),(0,s.jsx)(f,{rows:4,value:e$,onChange:e=>e0(e.target.value)}),(0,s.jsxs)("div",{className:"text-[11px] text-slate-500 mt-1",children:["Uses variables: ",H?"{audience} ":"",W?"{benefits} ":"",q?"{pain_points} ":"",V?"{title} ":""]}),(0,s.jsx)("div",{className:"text-[11px] text-slate-500 mt-1",children:"Preview:"}),(0,s.jsx)("pre",{className:"text-[11px] bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-32 overflow-auto",children:aJ(e$)}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsxs)("select",{className:"text-xs border rounded px-2 py-1",onChange:e=>{let a=Number(e.target.value);Number.isNaN(a)||ad("headlines",a)},defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"Versions…"}),aa.map(e=>(0,s.jsx)("option",{value:e.version,children:"v".concat(e.version," – ").concat(new Date(e.savedAt).toLocaleString())},e.version))]}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>ar("headlines"),children:"Save version"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>{try{localStorage.setItem("ptos_ads_headlines_prompt",e$)}catch(e){}},children:"Make default"})]})]}),(()=>{var e,a,t,i;let l=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun;return l?(0,s.jsxs)("div",{className:"text-xs space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Last run"}),(0,s.jsxs)("div",{children:["Model: ",l.model||"default"]}),(0,s.jsxs)("div",{children:["Duration: ",l.durationMs," ms"]}),(0,s.jsxs)("div",{children:["Started: ",new Date(l.startedAt).toLocaleString()]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Inputs:"}),(0,s.jsxs)("ul",{className:"list-disc pl-4",children:[(0,s.jsxs)("li",{children:["audience (",en.audience,"): ",H]}),(0,s.jsxs)("li",{children:["benefits (",en.benefits,"): ",((null===(a=l.inputSnapshot)||void 0===a?void 0:a.benefits)||[]).join(", ")]}),(0,s.jsxs)("li",{children:["pain_points (",en.pains,"): ",((null===(t=l.inputSnapshot)||void 0===t?void 0:t.pain_points)||[]).join(", ")]}),(0,s.jsxs)("li",{children:["title (",en.title,"): ",(null===(i=l.inputSnapshot)||void 0===i?void 0:i.title)||""]})]})]}):null})(),(0,s.jsx)("div",{children:(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>aP(aG.id),disabled:eT,children:"Generate headlines"})})]}),("copies"===aG.type||"copies_out"===aG.type)&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Ad copies prompt"}),(0,s.jsx)(f,{rows:4,value:e1,onChange:e=>e2(e.target.value)}),(0,s.jsxs)("div",{className:"text-[11px] text-slate-500 mt-1",children:["Uses variables: ",H?"{audience} ":"",W?"{benefits} ":"",q?"{pain_points} ":"",V?"{title} ":""]}),(0,s.jsx)("div",{className:"text-[11px] text-slate-500 mt-1",children:"Preview:"}),(0,s.jsx)("pre",{className:"text-[11px] bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-32 overflow-auto",children:aJ(e1)}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsxs)("select",{className:"text-xs border rounded px-2 py-1",onChange:e=>{let a=Number(e.target.value);Number.isNaN(a)||ad("copies",a)},defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"Versions…"}),as.map(e=>(0,s.jsx)("option",{value:e.version,children:"v".concat(e.version," – ").concat(new Date(e.savedAt).toLocaleString())},e.version))]}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>ar("copies"),children:"Save version"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>{try{localStorage.setItem("ptos_ads_copies_prompt",e1)}catch(e){}},children:"Make default"})]})]}),(()=>{var e;let a=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun;return a?(0,s.jsxs)("div",{className:"text-xs space-y-1",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Last run"}),(0,s.jsxs)("div",{children:["Model: ",a.model||"default"]}),(0,s.jsxs)("div",{children:["Duration: ",a.durationMs," ms"]}),(0,s.jsxs)("div",{children:["Started: ",new Date(a.startedAt).toLocaleString()]})]}):null})(),(0,s.jsx)("div",{children:(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>az(aG.id),disabled:eT,children:"Generate copies"})})]}),"headlines_out"===aG.type&&(0,s.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Headlines (EN)"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1",children:(Array.isArray(null===(E=aG.data)||void 0===E?void 0:E.headlines_en)?aG.data.headlines_en:Array.isArray(null===(O=aG.data)||void 0===O?void 0:O.headlines)?aG.data.headlines:[]).slice(0,12).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef===e,onChange:()=>ey(e)}),(0,s.jsx)("span",{children:e})]},a))}),Array.isArray(null===(R=aG.data)||void 0===R?void 0:R.headlines_fr)&&aG.data.headlines_fr.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-slate-500 mt-2",children:"Titres (FR)"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1",children:aG.data.headlines_fr.slice(0,12).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef===e,onChange:()=>ey(e)}),(0,s.jsx)("span",{children:e})]},a))})]}),Array.isArray(null===(M=aG.data)||void 0===M?void 0:M.headlines_ar)&&aG.data.headlines_ar.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-slate-500 mt-2",children:"العناوين (AR)"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1",children:aG.data.headlines_ar.slice(0,12).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef===e,onChange:()=>ey(e)}),(0,s.jsx)("span",{children:e})]},a))})]})]}),"copies_out"===aG.type&&(0,s.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Primary texts (EN)"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1",children:(Array.isArray(null===(P=aG.data)||void 0===P?void 0:P.primaries_en)?aG.data.primaries_en:Array.isArray(null===(z=aG.data)||void 0===z?void 0:z.primaries)?aG.data.primaries:[]).slice(0,12).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ej===e,onChange:()=>e_(e)}),(0,s.jsx)("span",{className:"whitespace-pre-line",children:e})]},a))}),Array.isArray(null===(L=aG.data)||void 0===L?void 0:L.primaries_fr)&&aG.data.primaries_fr.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-slate-500 mt-2",children:"Textes (FR)"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1",children:aG.data.primaries_fr.slice(0,12).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ej===e,onChange:()=>e_(e)}),(0,s.jsx)("span",{className:"whitespace-pre-line",children:e})]},a))})]}),Array.isArray(null===(U=aG.data)||void 0===U?void 0:U.primaries_ar)&&aG.data.primaries_ar.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-slate-500 mt-2",children:"النصوص (AR)"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1",children:aG.data.primaries_ar.slice(0,12).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ej===e,onChange:()=>e_(e)}),(0,s.jsx)("span",{className:"whitespace-pre-line",children:e})]},a))})]})]}),("gemini_images"===aG.type||"images_out"===aG.type)&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Ad image prompt"}),(0,s.jsx)(f,{rows:3,value:e5,onChange:e=>e3(e.target.value)}),(0,s.jsxs)("div",{className:"text-[11px] text-slate-500",children:["Uses variables: ",Q?"{offers} ":"","and selected image."]}),(0,s.jsx)("div",{className:"text-[11px] text-slate-500 mt-1",children:"Preview:"}),(0,s.jsx)("pre",{className:"text-[11px] bg-slate-50 border rounded p-2 whitespace-pre-wrap max-h-32 overflow-auto",children:aJ(e5)}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsxs)("select",{className:"text-xs border rounded px-2 py-1",onChange:e=>{let a=Number(e.target.value);Number.isNaN(a)||ad("gemini",a)},defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"Versions…"}),al.map(e=>(0,s.jsx)("option",{value:e.version,children:"v".concat(e.version," – ").concat(new Date(e.savedAt).toLocaleString())},e.version))]}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>ar("gemini"),children:"Save version"}),(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>{try{localStorage.setItem("ptos_ads_gemini_prompt",e5)}catch(e){}},children:"Make default"})]}),(()=>{var e,a;let t=((null===(e=aG.data)||void 0===e?void 0:e.meta)||{}).lastRun;return t?(0,s.jsxs)("div",{className:"text-xs space-y-1 mt-2",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Last run"}),(0,s.jsxs)("div",{children:["Model: ",t.model||"default"]}),(0,s.jsxs)("div",{children:["Duration: ",t.durationMs," ms"]}),(0,s.jsxs)("div",{children:["Started: ",new Date(t.startedAt).toLocaleString()]}),(0,s.jsxs)("div",{children:["Source image (",en.sourceImage,"): ",String((null===(a=t.inputSnapshot)||void 0===a?void 0:a.image_url)||"")]})]}):null})(),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>"gemini_images"===aG.type?aL(aG.id):aB(),disabled:eT,children:"Generate images (4)"}),"images_out"===aG.type&&Array.isArray(null===(D=aG.data)||void 0===D?void 0:D.images)&&aG.data.images.length>0&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m,{size:"sm",variant:"outline",onClick:()=>{try{var e;for(let a of(null===(e=aG.data)||void 0===e?void 0:e.images)||[]){let e=document.createElement("a");e.href=a,e.download="ad-image.jpg",document.body.appendChild(e),e.click(),e.remove()}}catch(e){}},children:"Download all"})})]}),eg.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:eg.map((e,a)=>(0,s.jsxs)("button",{className:"group border rounded overflow-hidden ".concat(e===eN?"ring-2 ring-blue-500":"ring-1 ring-slate-200"),onClick:()=>eb(e),children:[(0,s.jsx)("img",{src:eo(e),alt:"ad-".concat(a),className:"w-full h-28 object-cover"}),(0,s.jsx)("div",{className:"absolute bottom-1 right-1 opacity-0 group-hover:opacity-100 transition",children:(0,s.jsx)("button",{className:"text-[10px] px-1 py-0.5 rounded bg-white/90 border",onClick:a=>{a.preventDefault(),a.stopPropagation();try{let a=document.createElement("a");a.href=eo(e),a.download="ad-image.jpg",document.body.appendChild(a),a.click(),a.remove()}catch(e){}},children:"Download"})})]},a))})]}),"meta_ad"===aG.type&&(0,s.jsxs)("div",{className:"space-y-3",children:[(()=>{let e=aG.id,a=ak.filter(a=>a.to===e).map(e=>aw.find(a=>a.id===e.from)).filter(Boolean),t=a.filter(e=>"headlines_out"===e.type).flatMap(e=>{let a=e.data||{};return[...Array.isArray(a.headlines_en)?a.headlines_en:Array.isArray(a.headlines)?a.headlines:[],...Array.isArray(a.headlines_fr)?a.headlines_fr:[],...Array.isArray(a.headlines_ar)?a.headlines_ar:[]]}),i=a.filter(e=>"copies_out"===e.type).flatMap(e=>{let a=e.data||{};return[...Array.isArray(a.primaries_en)?a.primaries_en:Array.isArray(a.primaries)?a.primaries:[],...Array.isArray(a.primaries_fr)?a.primaries_fr:[],...Array.isArray(a.primaries_ar)?a.primaries_ar:[]]}),l=a.filter(e=>"images_out"===e.type).flatMap(e=>{var a;return Array.isArray(null===(a=e.data)||void 0===a?void 0:a.images)?e.data.images:[]});return(0,s.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-500 mb-1",children:"Select headline"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1 max-h-36 overflow-auto",children:t.slice(0,24).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ef===e,onChange:()=>ey(e)}),(0,s.jsx)("span",{children:e})]},a))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-500 mb-1",children:"Select primary text"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-1 max-h-36 overflow-auto",children:i.slice(0,24).map((e,a)=>(0,s.jsxs)("label",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:ej===e,onChange:()=>e_(e)}),(0,s.jsx)("span",{className:"whitespace-pre-line",children:e})]},a))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-500 mb-1",children:"Select image"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-auto",children:Array.from(new Set([...l.slice(0,24),...ei.slice(0,24)])).map((e,a)=>(0,s.jsx)("button",{className:"border rounded overflow-hidden ".concat(e===eN?"ring-2 ring-blue-500":"ring-1 ring-slate-200"),onClick:()=>eb(e),children:(0,s.jsx)("img",{src:eo(e),alt:"ad-".concat(a),className:"w-full h-20 object-cover"})},a))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-slate-500 mb-1",children:"Carousel images (select 2+)"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-auto",children:Array.from(new Set([...l.slice(0,24),...ei.slice(0,24)])).map((e,a)=>{let t=eA.includes(e);return(0,s.jsxs)("label",{className:"relative border rounded overflow-hidden ".concat(t?"ring-2 ring-blue-500":"ring-1 ring-slate-200"),children:[(0,s.jsx)("img",{src:eo(e),alt:"ad-".concat(a),className:"w-full h-20 object-cover"}),(0,s.jsx)("input",{type:"checkbox",className:"absolute top-1 left-1 bg-white/80",checked:t,onChange:()=>{ew(a=>t?a.filter(a=>a!==e):Array.from(new Set([...a,e])))}})]},a)})}),(0,s.jsxs)("div",{className:"text-[11px] text-slate-500 mt-1",children:["Selected: ",eA.length]})]})]})})(),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"CTA"}),(0,s.jsx)("select",{value:eS,onChange:e=>ek(e.target.value),className:"w-full rounded-xl border px-3 py-2",children:["SHOP_NOW","LEARN_MORE","SIGN_UP","SUBSCRIBE","GET_OFFER","BUY_NOW","CONTACT_US"].map(e=>(0,s.jsx)("option",{value:e,children:e.replaceAll("_"," ")},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Daily budget (USD)"}),(0,s.jsx)(v,{type:"number",min:1,value:String(eC),onChange:e=>eI(""===e.target.value?9:Number(e.target.value))})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("input",{type:"checkbox",checked:eE,onChange:e=>eO(e.target.checked)}),(0,s.jsx)("span",{children:"Advantage+ audience"})]})}),!eE&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Saved audience"}),(0,s.jsxs)("select",{value:eL,onChange:e=>eU(e.target.value),className:"w-full rounded-xl border px-3 py-2",children:[(0,s.jsx)("option",{value:"",children:"None"}),eD.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name||e.id},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Countries (comma-separated)"}),(0,s.jsx)(v,{value:eP,onChange:e=>ez(e.target.value),placeholder:"US, MA"})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(m,{onClick:aT,disabled:eT,children:"Approve & Create Draft"})})]})]})]})]})]})})]})]})}function _(){return(0,s.jsxs)("div",{className:"absolute inset-0",children:[(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none bg-[linear-gradient(to_right,_#eef2ff_1px,transparent_1px),linear-gradient(to_bottom,_#eef2ff_1px,transparent_1px)] bg-[size:24px_24px]"}),(0,s.jsx)("div",{className:"absolute inset-0 pointer-events-none bg-[radial-gradient(circle_at_20%_20%,rgba(59,130,246,0.06),transparent_30%),radial-gradient(circle_at_80%_60%,rgba(14,165,233,0.06),transparent_35%)]"})]})}function N(e){let{edge:a,nodes:t,active:i}=e,l=t.find(e=>e.id===a.from),n=t.find(e=>e.id===a.to);if(!l||!n)return null;let r=l.x+200,d=function(e,a,t,s){let i=.4*Math.abs(t-e);return"M ".concat(e," ").concat(a," C ").concat(e+i," ").concat(a,", ").concat(t-i," ").concat(s,", ").concat(t," ").concat(s)}(r,l.y+100,n.x+20,n.y+100);return(0,s.jsxs)("svg",{className:"absolute overflow-visible pointer-events-none",style:{left:0,top:0},children:[(0,s.jsxs)("defs",{children:[(0,s.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",markerUnits:"strokeWidth",children:(0,s.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#94a3b8"})}),(0,s.jsx)("marker",{id:"arrowhead-active",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",markerUnits:"strokeWidth",children:(0,s.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#3b82f6"})})]}),(0,s.jsx)("path",{d:d,className:"fill-none ".concat(i?"edge edge-active":"edge"),strokeWidth:i?3:2,strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke",markerEnd:i?"url(#arrowhead-active)":"url(#arrowhead)"})]})}},2757:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(8030).Z)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},399:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(8030).Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]])},7138:function(e,a,t){"use strict";t.d(a,{default:function(){return i.a}});var s=t(231),i=t.n(s)},6463:function(e,a,t){"use strict";var s=t(1169);t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[472,231,264,971,23,744],function(){return e(e.s=4137)}),_N_E=e.O()}]);
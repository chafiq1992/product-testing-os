(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[218],{9541:function(e,t,a){Promise.resolve().then(a.bind(a,5685))},5685:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),l=a(2265),n=a(7138),r=a(3541),i=a(8030);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,i.Z)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var c=a(2757),o=a(6706),u=a(1077);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,i.Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),m=(0,i.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),p=(0,i.Z)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var h=a(6264);function g(){let[e,t]=(0,l.useState)([]),[a,i]=(0,l.useState)(!1),g=(0,l.useRef)(0),[b,j]=(0,l.useState)("last_7d_incl_today"),[v,N]=(0,l.useState)(""),[_,S]=(0,l.useState)(""),[w,k]=(0,l.useState)(void 0),[C,M]=(0,l.useState)({}),P=(0,l.useRef)(0),[A,O]=(0,l.useState)(()=>{try{return localStorage.getItem("ptos_store")||"irrakids"}catch(e){return"irrakids"}}),[D,T]=(0,l.useState)(()=>{try{return localStorage.getItem("ptos_ad_account")||""}catch(e){return""}}),[z,F]=(0,l.useState)([]),[I,Z]=(0,l.useState)({}),[L,$]=(0,l.useState)(""),[E,R]=(0,l.useState)(()=>{try{return JSON.parse(localStorage.getItem("ptos_notes")||"{}")}catch(e){return{}}}),[H,J]=(0,l.useState)({}),[U,V]=(0,l.useState)({}),[q,B]=(0,l.useState)({}),[Y,W]=(0,l.useState)({}),[Q,G]=(0,l.useState)({}),[X,K]=(0,l.useState)({}),[ee,et]=(0,l.useState)({}),[ea,es]=(0,l.useState)({}),[el,en]=(0,l.useState)({}),[er,ei]=(0,l.useState)({}),[ed,ec]=(0,l.useState)({}),[eo,eu]=(0,l.useState)({}),[ex,em]=(0,l.useState)({}),[ep,eh]=(0,l.useState)({}),[eg,ef]=(0,l.useState)({}),[ey,eb]=(0,l.useState)("spend"),[ej,ev]=(0,l.useState)("desc"),[eN,e_]=(0,l.useState)(!1),[eS,ew]=(0,l.useState)(!1),[ek,eC]=(0,l.useState)(null),[eM,eP]=(0,l.useState)([]),[eA,eO]=(0,l.useState)([]),[eD,eT]=(0,l.useState)(null),[ez,eF]=(0,l.useState)(()=>{try{return JSON.parse(localStorage.getItem("ptos_ads_selected")||"{}")}catch(e){return{}}}),[eI,eZ]=(0,l.useState)(()=>{try{return JSON.parse(localStorage.getItem("ptos_ads_merged")||"{}")}catch(e){return{}}}),[eL,e$]=(0,l.useState)(()=>{try{return JSON.parse(localStorage.getItem("ptos_ads_group_notes")||"{}")}catch(e){return{}}}),[eE,eR]=(0,l.useState)({}),[eH,eJ]=(0,l.useState)(()=>({open:!1})),[eU,eV]=(0,l.useState)(!1),[eq,eB]=(0,l.useState)(""),eY=(0,l.useMemo)(()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone||void 0}catch(e){return}},[]),eW=(0,l.useMemo)(()=>(e||[]).reduce((e,t)=>e+Number(t.spend||0),0),[e]),eQ=(0,l.useMemo)(()=>{let t={};for(let a of e||[])t[String(a.campaign_id||a.name||"")]=a;let a={},s=0;for(let l of e||[]){let e=String(l.campaign_id||l.name||"");if(a[e])continue;let n=eI[e];if(n)t[n],s+=e8(l)||0,a[e]=!0,a[n]=!0;else{let t=e8(l);"number"==typeof t&&t>0&&(s+=t),a[e]=!0}}return s},[e,C,q,H,eI]),eG=(0,l.useMemo)(()=>eQ>0?eW/eQ:null,[eW,eQ]),eX=(0,l.useMemo)(()=>(eD||0)>0?eW/Number(eD||0):null,[eW,eD]);function eK(e){try{return e.toLocaleString(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2})}catch(t){return"$".concat((e||0).toFixed(2))}}function e0(e){try{return Math.round(e||0).toLocaleString()}catch(t){return String(Math.round(e||0))}}function e1(e){let t=String(e||"").match(/(\d{3,})/);return t?t[1]:null}function e2(e){let t=new Date,a=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)},s=new Date(t),l=new Date(t);switch(e){case"today":l.setHours(0,0,0,0);break;case"yesterday":{let e=new Date(t);e.setDate(e.getDate()-1),e.setHours(0,0,0,0);let s=new Date(e);return s.setHours(23,59,59,999),{start:a(e),end:a(s)}}case"last_3d_incl_today":l.setDate(l.getDate()-2);break;case"last_4d_incl_today":l.setDate(l.getDate()-3);break;case"last_5d_incl_today":l.setDate(l.getDate()-4);break;case"last_6d_incl_today":l.setDate(l.getDate()-5);break;default:l.setDate(l.getDate()-6)}return l.setHours(0,0,0,0),{start:a(l),end:a(s)}}function e5(e){if("custom"===e){if(v&&_)return{range:{start:v,end:_}};let{start:e,end:t}=e2("last_7d_incl_today");return{range:{start:e,end:t}}}if("last_3d_incl_today"===e||"last_4d_incl_today"===e||"last_5d_incl_today"===e||"last_6d_incl_today"===e||"last_7d_incl_today"===e){let{start:t,end:a}=e2(e);return{range:{start:t,end:a}}}if("today"===e)return{datePreset:"today"};if("yesterday"===e)return{datePreset:"yesterday"};let{start:t,end:a}=e2("last_7d_incl_today");return{range:{start:t,end:a}}}function e3(e){return"custom"===e&&v&&_?{start:v,end:_}:e2(e)}async function e4(e,a){let s=++g.current;i(!0),k(void 0);try{var l,n,r,d,c,o,u,x,m,p,f,y,j;let v=e||b,N=null!==(l=null==a?void 0:a.store)&&void 0!==l?l:A,_=null!==(n=null==a?void 0:a.adAccount)&&void 0!==n?n:D,S=e5(v),{start:w,end:C}=e3(v),O=[],z={};try{let e=await (0,h.so)({date_preset:S.datePreset,ad_account:_||void 0,store:N,start:(null===(r=S.range)||void 0===r?void 0:r.start)||w,end:(null===(d=S.range)||void 0===d?void 0:d.end)||C});if(s!==g.current)return;let t=null==e?void 0:e.data;if((null==e?void 0:e.error)&&!(null==t?void 0:null===(c=t.campaigns)||void 0===c?void 0:c.length))throw Error(String(e.error));O=(null==t?void 0:t.campaigns)||[];let a=null==t?void 0:t.ad_account;if(null==a?void 0:a.id){T(String(a.id||"")),$(String(a.name||""));try{localStorage.setItem("ptos_ad_account",String(a.id||""))}catch(e){}}let l=(null==t?void 0:t.mappings)||{};for(let e of Object.keys(l)){let t=l[e];t&&("product"===t.kind||"collection"===t.kind)&&t.id&&(z[e]={kind:t.kind,id:t.id})}eR((null==t?void 0:t.campaign_meta)||{})}catch(e){if(s!==g.current)return;try{let e=await (0,h._X)(S.datePreset,_||void 0,S.range);if(s!==g.current)return;if(null==e?void 0:e.error){k(String(e.error)),t([]);return}O=(null==e?void 0:e.data)||[]}catch(e){k(String((null==e?void 0:e.message)||e)),t([]);return}try{let[e,t]=await Promise.allSettled([(0,h.zO)(N),(0,h.u1)(N)]);if("fulfilled"===e.status){let t=(null===(u=e.value)||void 0===u?void 0:u.data)||{};for(let e of Object.keys(t)){let a=t[e];a&&("product"===a.kind||"collection"===a.kind)&&a.id&&(z[e]={kind:a.kind,id:a.id})}}"fulfilled"===t.status&&eR((null===(o=t.value)||void 0===o?void 0:o.data)||{})}catch(e){}}t(O),J(z),M({}),Z({}),B({}),eT(null),W({}),G({}),K({}),et({}),es({}),en({}),ei({}),ec({}),eu({}),em({}),i(!1);let F=++P.current,{start:I,end:L}=e3(v);(async()=>{try{let e=await (0,h.D6)({start:I,end:L,store:N,include_closed:!0,date_field:"processed"});if(F!==P.current)return;eT(Number(((e||{}).data||{}).count||0))}catch(e){if(F!==P.current)return;eT(0)}})();let E=O.slice().sort((e,t)=>Number(t.spend||0)-Number(e.spend||0)),R=[],H={};for(let e of E){let t=z[e.campaign_id||e.name||""],a=null;(a=t&&"product"===t.kind&&t.id&&/^\d+$/.test(t.id)?t.id:e1(e.name||""))&&!H[a]&&(H[a]=!0,R.push(a))}let U={};for(let e=0;e<R.length&&F===P.current;e+=4){let t=R.slice(e,e+4),[a,s]=await Promise.allSettled([(0,h.$8)({ids:t,store:N}),(0,h._R)({names:t,start:I,end:L,include_closed:!0,date_field:"processed"})]);if(F!==P.current)break;if("fulfilled"===a.status){let e=(null===(x=a.value)||void 0===x?void 0:x.data)||{};Z(t=>({...t,...e}))}let l={};if("fulfilled"===s.status){let e=(null===(m=s.value)||void 0===m?void 0:m.data)||{};for(let a of t){let t=Number(null!==(p=e[a])&&void 0!==p?p:0)||0;l[a]=t,U[a]=t}}else for(let e of t)l[e]=0,U[e]=0;M(e=>({...e,...l}))}for(let e of E){if(F!==P.current)break;let t=e.campaign_id||e.name||"";try{let e=z[t];if(!e||!e.id||!/^\d+$/.test(e.id))continue;if("product"===e.kind){let a=Number(null!==(f=U[e.id])&&void 0!==f?f:0)||0;B(e=>({...e,[String(t)]:a}))}else{let a=await (0,h.ew)({collection_id:e.id,start:I,end:L,store:N,include_closed:!0,aggregate:"sum_product_orders",date_field:"processed"}),s=Number(null!==(j=null===(y=(null==a?void 0:a.data)||{})||void 0===y?void 0:y.count)&&void 0!==j?j:0);B(e=>({...e,[String(t)]:s}))}}catch(e){B(e=>({...e,[String(t)]:0}))}}}catch(e){k(String((null==e?void 0:e.message)||e)),t([])}finally{s===g.current&&i(!1)}}async function e7(e,t){et(t=>({...t,[String(e)]:!0}));try{let{data:a}=await (0,h.fh)({collection_id:t,store:A}),s=(a||{}).product_ids||[];G(t=>({...t,[String(e)]:s}));let{start:l,end:n}=e3(b);try{let t=await (0,h._R)({names:s,start:l,end:n,include_closed:!0,date_field:"processed"}),a=(null==t?void 0:t.data)||{};K(t=>({...t,[String(e)]:a}));let r=s.reduce((e,t)=>{var s;return e+(Number(null!==(s=a[t])&&void 0!==s?s:0)||0)},0);B(t=>({...t,[String(e)]:r}))}catch(a){let t={};for(let e of s)t[e]=0;K(a=>({...a,[String(e)]:t})),B(t=>({...t,[String(e)]:0}))}}finally{et(t=>({...t,[String(e)]:!1}))}}function e6(e){return(e.name||"").trim()}function e8(e){let t=e6(e),a=e.campaign_id||e.name||"";if(H[a]&&null!=q[String(a)])return q[String(a)];let s=e1(t);if(!s)return null;let l=C[s];return"number"==typeof l?l:null}function e9(e){switch(ey){case"campaign":return(e.name||"").toLowerCase();case"spend":return e.spend||0;case"purchases":return e.purchases||0;case"cpp":return null==e.cpp?null:Number(e.cpp);case"ctr":return null==e.ctr?null:Number(e.ctr);case"add_to_cart":return e.add_to_cart||0;case"shopify_orders":return e8(e);case"true_cpp":return function(e){let t=e8(e);return null==t||t<=0?null:(e.spend||0)/t}(e);case"inventory":return function(e){let t=H[e.campaign_id||e.name||""],a=null;if(!(a=t&&"product"===t.kind&&t.id?t.id:e1(e6(e))))return null;let s=I[a];return s&&"number"==typeof s.total_available?s.total_available:null}(e);case"zero_variant":return function(e){let t=H[e.campaign_id||e.name||""],a=null;if(!(a=t&&"product"===t.kind&&t.id?t.id:e1(e6(e))))return null;let s=I[a];return s?"number"==typeof s.zero_sizes?Number(s.zero_sizes||0):"number"==typeof s.zero_variants?Number(s.zero_variants||0):null:null}(e);default:return null}}function te(e,t){let a=e9(e),s=e9(t),l=null==a,n=null==s;if(l&&n)return 0;if(l&&!n)return 1;if(!l&&n)return -1;let r=0;return r="string"==typeof a||"string"==typeof s?String(a).localeCompare(String(s)):(Number(a)||0)-(Number(s)||0),"asc"===ej?r:-r}(0,l.useEffect)(()=>{let{start:e,end:t}=e2("last_7d_incl_today");N(e),S(t)},[]),(0,l.useEffect)(()=>{let e=async()=>{try{let e=await (0,h.C4)(),t=(null==e?void 0:e.data)||[],a={};for(let e of t)a[e.id]=e;for(let e of[{id:"8127151147322914",name:"8127151147322914"}])a[e.id]||(a[e.id]=e);F(Object.values(a))}catch(e){F([])}};return(async()=>{e(),e4(void 0,{store:A,adAccount:D||void 0})})(),()=>{}},[A]);let tt=(0,l.useMemo)(()=>{let t=(e||[]).slice();try{t.sort(te)}catch(e){}let a={};for(let e of t)a[String(e.campaign_id||e.name||"")]=e;let s={},l=[];for(let e of t){let t=String(e.campaign_id||e.name||"");if(s[t])continue;let n=eI[t];n&&a[n]?(l.push(e),l.push(a[n]),s[t]=!0,s[n]=!0):(l.push(e),s[t]=!0)}return l},[e,ey,ej,C,I,eI]);function ta(e,t){return[e,t].map(String).sort().join("||")}function ts(e){ey===e?ev(e=>"asc"===e?"desc":"asc"):(eb(e),ev("desc"))}function tl(){return"asc"===ej?(0,s.jsx)(r.Z,{className:"w-3.5 h-3.5"}):(0,s.jsx)(d,{className:"w-3.5 h-3.5"})}return(0,s.jsxs)("div",{className:"min-h-screen w-full bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-sky-50 via-white to-indigo-50 text-slate-800",children:[(0,s.jsxs)("header",{className:"min-h-16 py-2 px-4 md:px-6 flex items-center justify-between border-b bg-white/70 backdrop-blur sticky top-0 z-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.Z,{className:"w-6 h-6 text-blue-600"}),(0,s.jsx)("h1",{className:"font-semibold text-lg",children:"Ads management"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[(0,s.jsxs)("select",{value:A,onChange:e=>{let t=e.target.value;O(t);try{localStorage.setItem("ptos_store",t)}catch(e){}},className:"rounded-xl border px-2 py-1 text-sm bg-white",children:[(0,s.jsx)("option",{value:"irrakids",children:"irrakids"}),(0,s.jsx)("option",{value:"irranova",children:"irranova"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("select",{value:D,onChange:async e=>{let t=e.target.value;T(t);try{localStorage.setItem("ptos_ad_account",t)}catch(e){}try{var a;let e=await (0,h.UI)({id:t,store:A}),s=(null==e?void 0:e.data)||{};$(String(s&&s.name?s.name:(null===(a=z.find(e=>e.id===t))||void 0===a?void 0:a.name)||""))}catch(e){}e4(void 0,{adAccount:t})},className:"rounded-xl border px-2 py-1 text-sm bg-white w-44 sm:w-56 md:w-72",children:[(0,s.jsx)("option",{value:"",children:"Select ad account…"}),z.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name||e.id," (",e.id,")"]},e.id))]}),L?(0,s.jsx)("span",{className:"text-xs text-slate-600",children:L}):null]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("select",{value:b,onChange:e=>{let t=e.target.value;j(t),"custom"!==t&&e4(t)},className:"rounded-xl border px-2 py-1 text-sm bg-white",children:[(0,s.jsx)("option",{value:"today",children:"Today"}),(0,s.jsx)("option",{value:"yesterday",children:"Yesterday"}),(0,s.jsx)("option",{value:"last_3d_incl_today",children:"Last 3 days (including today)"}),(0,s.jsx)("option",{value:"last_4d_incl_today",children:"Last 4 days (including today)"}),(0,s.jsx)("option",{value:"last_5d_incl_today",children:"Last 5 days (including today)"}),(0,s.jsx)("option",{value:"last_6d_incl_today",children:"Last 6 days (including today)"}),(0,s.jsx)("option",{value:"last_7d_incl_today",children:"Last 7 days (including today)"}),(0,s.jsx)("option",{value:"custom",children:"Custom…"})]}),"custom"===b&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,s.jsx)("input",{type:"date",value:v,onChange:e=>N(e.target.value),className:"rounded-xl border px-2 py-1 bg-white"}),(0,s.jsx)("span",{children:"to"}),(0,s.jsx)("input",{type:"date",value:_,onChange:e=>S(e.target.value),className:"rounded-xl border px-2 py-1 bg-white"}),(0,s.jsx)("button",{onClick:()=>e4("custom"),className:"rounded-xl font-semibold inline-flex items-center gap-2 px-2 py-1 bg-slate-200 hover:bg-slate-300",children:"Apply"})]})]}),(0,s.jsxs)("button",{onClick:()=>e4(),className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white text-sm disabled:opacity-60",disabled:a,children:[(0,s.jsx)(o.Z,{className:"w-4 h-4 ".concat(a?"animate-spin":"")})," ",a?"Updating…":"Refresh"]}),(0,s.jsx)(n.default,{href:"/",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:"Home"})]})]}),(0,s.jsxs)("div",{className:"p-4 md:p-6",children:[w&&(0,s.jsx)("div",{className:"mb-3 text-sm text-red-600",children:w}),(0,s.jsx)("div",{className:"mb-4 rounded-2xl overflow-hidden shadow-lg bg-gradient-to-r from-indigo-600 via-blue-600 to-cyan-500 text-white",children:(0,s.jsxs)("div",{className:"p-4 md:p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs uppercase/relaxed opacity-80",children:"Ad account"}),(0,s.jsx)("div",{className:"text-lg font-semibold",children:L||D||"—"}),(0,s.jsxs)("div",{className:"text-xs opacity-80",children:["Range: ","custom"===b?"".concat(v||"—"," to ").concat(_||"—"):function(e){switch(e){case"today":return"today";case"yesterday":return"yesterday";case"last_3d_incl_today":return"last 3 days (including today)";case"last_4d_incl_today":return"last 4 days (including today)";case"last_5d_incl_today":return"last 5 days (including today)";case"last_6d_incl_today":return"last 6 days (including today)";case"last_7d_incl_today":return"last 7 days (including today)";case"custom":return"custom";default:return e}}(b)," • Store: ",A]})]}),(0,s.jsxs)("div",{className:"text-sm opacity-90 flex items-center gap-2",children:[(0,s.jsx)(c.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Performance overview"})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-90",children:[(0,s.jsx)("span",{children:"Total Spend"}),(0,s.jsx)(u.Z,{className:"w-4 h-4 opacity-90"})]}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:eK(eW)})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-90",children:[(0,s.jsx)("span",{children:"Shopify Orders (table)"}),(0,s.jsx)(x,{className:"w-4 h-4 opacity-90"})]}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:e0(eQ)})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-90",children:[(0,s.jsx)("span",{children:"Store Orders (all)"}),(0,s.jsx)(x,{className:"w-4 h-4 opacity-90"})]}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:null!=eD?e0(eD):"—"})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-90",children:[(0,s.jsx)("span",{children:"Total CPP"}),(0,s.jsx)(m,{className:"w-4 h-4 opacity-90"})]}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:null!=eG?eK(eG):"—"})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs opacity-90",children:[(0,s.jsx)("span",{children:"Full Store CPP"}),(0,s.jsx)(m,{className:"w-4 h-4 opacity-90"})]}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:null!=eX?eK(eX):"—"})]})]})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"Select 2 rows to merge Shopify metrics."}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("button",{onClick:function(){let e=Object.keys(ez).filter(e=>!!ez[e]);if(2!==e.length){alert("Select exactly 2 rows to merge.");return}let[t,a]=e;eZ(e=>{let s={...e},l=s[t],n=s[a];l&&(delete s[l],delete s[t]),n&&(delete s[n],delete s[a]),s[t]=a,s[a]=t;try{localStorage.setItem("ptos_ads_merged",JSON.stringify(s))}catch(e){}return s});let s=ta(t,a);e$(e=>{let t={...e};null==t[s]&&(t[s]="");try{localStorage.setItem("ptos_ads_group_notes",JSON.stringify(t))}catch(e){}return t}),eF(()=>{try{localStorage.setItem("ptos_ads_selected","{}")}catch(e){}return{}})},className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-sm disabled:opacity-60",disabled:2!==Object.keys(ez).filter(e=>ez[e]).length,children:"Merge 2"})})]}),(0,s.jsx)("div",{className:"overflow-x-auto bg-white border rounded-none",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-slate-50/90 backdrop-blur supports-backdrop-blur:bg-slate-50/60 border-b shadow-sm",children:(0,s.jsxs)("tr",{className:"text-left",children:[(0,s.jsx)("th",{className:"px-3 py-2 font-semibold w-8",children:"Sel"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:"Product"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:(0,s.jsxs)("button",{onClick:()=>ts("campaign"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"Campaign"}),"campaign"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:(0,s.jsx)("span",{children:"Status"})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("spend"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"Spend"}),"spend"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("purchases"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"Purchases"}),"purchases"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("cpp"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"Cost / Purchase"}),"cpp"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("ctr"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"CTR"}),"ctr"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("add_to_cart"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"Add to cart"}),"add_to_cart"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-emerald-700",children:(0,s.jsxs)("button",{onClick:()=>ts("shopify_orders"),className:"inline-flex items-center gap-1 hover:text-emerald-800",children:[(0,s.jsx)("span",{children:"Shopify Orders"}),"shopify_orders"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-emerald-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("true_cpp"),className:"inline-flex items-center gap-1 hover:text-slate-900",children:[(0,s.jsx)("span",{children:"True CPP"}),"true_cpp"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-slate-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:(0,s.jsx)("span",{children:"Supplier"})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:(0,s.jsx)("span",{children:"Supply available"})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-indigo-700 text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("inventory"),className:"inline-flex items-center gap-1 hover:text-indigo-800",children:[(0,s.jsx)("span",{children:"Inventory"}),"inventory"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-indigo-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-rose-700 text-right",children:(0,s.jsxs)("button",{onClick:()=>ts("zero_variant"),className:"inline-flex items-center gap-1 hover:text-rose-800",children:[(0,s.jsx)("span",{children:"Zero-variant"}),"zero_variant"===ey?(0,s.jsx)(tl,{}):(0,s.jsx)(p,{className:"w-3.5 h-3.5 text-rose-400"})]})}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:"Notes"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Actions"})]})}),(0,s.jsxs)("tbody",{children:[a&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:17,className:"px-3 py-6 text-center text-slate-500",children:"Loading…"})}),!a&&0===e.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:17,className:"px-3 py-6 text-center text-slate-500",children:"No active campaigns."})}),!a&&tt.map(e=>{let a=null!=e.cpp?"$".concat(e.cpp.toFixed(2)):"—",n=null!=e.ctr?"".concat((1*e.ctr).toFixed(2),"%"):"—",r=String(e.campaign_id||e.name||""),i=eI[r],d=(tt||[]).find(e=>String(e.campaign_id||e.name||"")===i),c=e8(e),o=null!=c&&c>0?((e.spend||0)+((null==d?void 0:d.spend)||0))/c:null,u=null!=o?"$".concat(o.toFixed(2)):"—",x=H[e.campaign_id||e.name||""],m=x&&"product"===x.kind&&x.id?x.id:e1((e.name||"").trim()),p=m?I[m]:void 0,g=p?p.image:null,f=p?p.total_available:null,y=p?p.zero_variants:null,j=d?d.campaign_id||d.name||"":null,N=j?H[j]:void 0,S=d?N&&"product"===N.kind&&N.id?N.id:e1((d.name||"").trim()):null,w=S?I[S]:void 0;w&&w.total_available,w&&w.zero_variants;let k=null==f||void 0==f?null:Number(f||0),C=null==y||void 0==y?null:Number(y||0),M=!!m||!!S;return(0,s.jsxs)(l.Fragment,{children:[(0,s.jsxs)("tr",{className:"border-b last:border-b-0 ".concat(null==o?"":o<2?"bg-emerald-50":o<3?"bg-amber-50":"bg-rose-50"," ").concat(null==o?"border-l-2 border-l-transparent":o<2?"border-l-4 border-l-emerald-400":o<3?"border-l-4 border-l-amber-400":"border-l-4 border-l-rose-400"),children:[(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsx)("input",{type:"checkbox",checked:!!ez[String(r)],onChange:e=>{var t,a;return t=String(r),a=e.target.checked,void eF(e=>{let s={...e,[t]:null==a?!e[t]:!!a};try{localStorage.setItem("ptos_ads_selected",JSON.stringify(s))}catch(e){}return s})}})}),(0,s.jsx)("td",{className:"px-3 py-2",children:g?(0,s.jsx)("img",{src:g,alt:"product",className:"w-20 h-20 rounded object-cover border"}):M?(0,s.jsx)("span",{className:"inline-block w-20 h-20 rounded bg-slate-100 border animate-pulse"}):(0,s.jsx)("span",{className:"inline-block w-20 h-20 rounded bg-slate-50 border"})}),(0,s.jsxs)("td",{className:"px-3 py-2 whitespace-nowrap",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:async()=>{let t=String(e.campaign_id||"");if(!t)return;let a=!ea[t];if(es(e=>({...e,[t]:a})),a&&!er[t])try{en(e=>({...e,[t]:!0}));let e=e5(b),a=await (0,h.tY)(t,e.datePreset,e.range),s=(null==a?void 0:a.data)||[];ei(e=>({...e,[t]:s}));try{let e="custom"===b&&v&&_?{start:v,end:_}:e2(b);eu(e=>({...e,[t]:!0}));let a=await (0,h.pN)(t,e,A),s=(null==a?void 0:a.data)||{};ec(e=>({...e,[t]:s}))}catch(e){ec(e=>({...e,[t]:{}}))}finally{eu(e=>({...e,[t]:!1}))}}catch(e){ei(e=>({...e,[t]:[]}))}finally{en(e=>({...e,[t]:!1}))}},className:"px-1.5 py-0.5 rounded bg-slate-100 hover:bg-slate-200 text-xs",children:ea[String(e.campaign_id||"")]?"▾":"▸"}),(0,s.jsx)("span",{children:e.name||"-"})]}),(()=>{let e=eE[String(r)]||{},t=(e.supplier_name||"").trim(),a=String(e.supply_available||e.supplier_alt_name||"").trim().toLowerCase(),l=a?["yes","y","true","1"].includes(a)?"Yes":"No":"";return t||l?(0,s.jsxs)("div",{className:"mt-1 text-xs text-slate-500",children:[t?(0,s.jsxs)("span",{className:"mr-2",children:["Supplier: ",(0,s.jsx)("span",{className:"font-medium text-slate-700",children:t})]}):null,l?(0,s.jsxs)("span",{children:["Supply available: ",(0,s.jsx)("span",{className:"font-medium text-slate-700",children:l})]}):null]}):null})(),(0,s.jsx)("div",{className:"mt-1 flex items-center gap-1",children:(()=>{var t,a;let l=e.campaign_id||e.name||"",n=U[l]||H[l]||{kind:"product",id:""};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("select",{value:n.kind,onChange:e=>V(t=>({...t,[l]:{...t[l]||{id:"",kind:"product"},kind:e.target.value}})),className:"border rounded px-1 py-0.5 text-xs bg-white",children:[(0,s.jsx)("option",{value:"product",children:"Product"}),(0,s.jsx)("option",{value:"collection",children:"Collection"})]}),(0,s.jsx)("input",{value:n.id||"",onChange:e=>V(t=>({...t,[l]:{...t[l]||{kind:n.kind},id:e.target.value.replace(/[^0-9]/g,"")}})),placeholder:"ID",className:"w-24 border rounded px-2 py-0.5 text-xs bg-white"}),(0,s.jsx)("button",{onClick:async()=>{var e,t,a,s,r;let i={kind:(null===(e=U[l])||void 0===e?void 0:e.kind)||n.kind,id:((null===(t=U[l])||void 0===t?void 0:t.id)||n.id||"").trim()};J(e=>({...e,[l]:i}));try{try{await (0,h.sQ)({campaign_key:String(l),kind:i.kind,id:i.id,store:A})}catch(e){}let{start:e,end:t}=e2(b);if("product"===i.kind){try{let e=await (0,h.$8)({ids:[i.id],store:A});Z(t=>({...t,...(null==e?void 0:e.data)||{}}))}catch(e){}let s=await (0,h._R)({names:[i.id],start:e,end:t,include_closed:!0}),n=null!==(a=((null==s?void 0:s.data)||{})[i.id])&&void 0!==a?a:0;B(e=>({...e,[String(l)]:n}))}else{let a=await (0,h.ew)({collection_id:i.id,start:e,end:t,store:A,include_closed:!0,aggregate:"sum_product_orders"}),n=Number(null!==(r=null===(s=(null==a?void 0:a.data)||{})||void 0===s?void 0:s.count)&&void 0!==r?r:0);B(e=>({...e,[String(l)]:n})),await e7(l,i.id)}}catch(e){B(e=>({...e,[String(l)]:0}))}},className:"px-2 py-0.5 rounded bg-slate-200 hover:bg-slate-300 text-xs",children:"Save"}),H[l]&&(null===(t=H[l])||void 0===t?void 0:t.kind)==="collection"&&(null===(a=H[l])||void 0===a?void 0:a.id)&&(0,s.jsx)("button",{onClick:async()=>{let e=!Y[String(l)];if(W(t=>({...t,[String(l)]:e})),e){let e=String((H[l]||{}).id||"");e&&await e7(l,e)}},className:"px-2 py-0.5 rounded bg-blue-100 hover:bg-blue-200 text-blue-700 text-xs",children:Y[String(l)]?"Hide products":"Show products"}),H[l]&&(0,s.jsx)("button",{onClick:()=>{J(e=>{let t={...e};delete t[l];try{localStorage.setItem("ptos_campaign_ids",JSON.stringify(t))}catch(e){}return t}),V(e=>{let t={...e};return delete t[l],t}),B(e=>{let t={...e};return delete t[String(l)],t}),W(e=>{let t={...e};return delete t[String(l)],t}),G(e=>{let t={...e};return delete t[String(l)],t}),K(e=>{let t={...e};return delete t[String(l)],t})},className:"px-2 py-0.5 rounded bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs",children:"Clear"})]})})()})]}),(0,s.jsx)("td",{className:"px-3 py-2",children:(()=>{let a="ACTIVE"===(e.status||"").toUpperCase(),l=a?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700",n=String(e.campaign_id||"");return(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ".concat(l),children:a?"Active":"Paused"}),e.campaign_id&&(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:a,disabled:!!ep[n],onChange:async a=>{let s=a.target.checked?"ACTIVE":"PAUSED";if(window.confirm("Turn ".concat("ACTIVE"===s?"ON":"OFF"," this campaign?")))try{eh(e=>({...e,[n]:!0})),await (0,h.QO)(String(n),s),t(t=>t.map(t=>t.campaign_id===e.campaign_id?{...t,status:s}:t))}catch(e){alert("Failed to update status")}finally{eh(e=>({...e,[n]:!1}))}},className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-10 h-5 bg-gray-200 rounded-full peer peer-checked:bg-emerald-500 transition-colors",children:(0,s.jsx)("div",{className:"w-4 h-4 bg-white rounded-full shadow transform transition-transform translate-x-0 peer-checked:translate-x-5 mt-0.5 ml-0.5"})})]})]})})()}),(0,s.jsxs)("td",{className:"px-3 py-2 text-right",children:["$",(e.spend||0).toFixed(2)]}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:e.purchases||0}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:a}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:n}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:e.add_to_cart||0}),(0,s.jsx)("td",{className:"px-3 py-2",children:null==c?(0,s.jsx)("span",{className:"text-slate-400",children:"—"}):(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-700",children:c})}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:null==c?(0,s.jsx)("span",{className:"inline-block h-4 w-12 bg-slate-100 rounded animate-pulse"}):u}),(0,s.jsx)("td",{className:"px-3 py-2",children:(()=>{let e=String(r),t=eE[e]||{};return(0,s.jsx)("input",{value:t.supplier_name||"",onChange:t=>{let a=t.target.value;eR(t=>({...t,[e]:{...t[e]||{},supplier_name:a}}))},onBlur:async t=>{let a=t.target.value;try{await (0,h.H4)({campaign_key:e,supplier_name:a,store:A})}catch(e){}},placeholder:"Supplier name",className:"w-44 rounded-md border px-2 py-1 text-sm bg-white"})})()}),(0,s.jsx)("td",{className:"px-3 py-2",children:(()=>{let e=String(r),t=eE[e]||{},a=String(t.supply_available||t.supplier_alt_name||"").trim().toLowerCase(),l="yes"===a||"y"===a||"true"===a||"1"===a;return(0,s.jsx)("button",{onClick:async()=>{let t=l?"no":"yes";eR(a=>({...a,[e]:{...a[e]||{},supply_available:t,supplier_alt_name:t}}));try{await (0,h.H4)({campaign_key:e,supply_available:t,store:A})}catch(e){}},className:"px-2 py-0.5 rounded text-xs ".concat(l?"bg-emerald-100 text-emerald-700 border border-emerald-200":"bg-rose-100 text-rose-700 border border-rose-200"),title:"Toggle supply availability",children:l?"Yes":"No"})})()}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:M?null==k?(0,s.jsx)("span",{className:"inline-block h-4 w-10 bg-indigo-50 rounded animate-pulse"}):(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-indigo-100 text-indigo-700",children:k}):(0,s.jsx)("span",{className:"text-slate-400",children:"—"})}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:M?null==C?(0,s.jsx)("span",{className:"inline-block h-4 w-10 bg-rose-50 rounded animate-pulse"}):(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ".concat(C>0?"bg-rose-100 text-rose-700":"bg-emerald-100 text-emerald-700"),children:C}):(0,s.jsx)("span",{className:"text-slate-400",children:"—"})}),(0,s.jsx)("td",{className:"px-3 py-2",children:(()=>{let e=eI[String(r)];if(e){let t=ta(String(r),String(e)),a=eL[t]||"";return(0,s.jsx)("input",{value:a,onChange:e=>{let a=e.target.value;e$(e=>{let s={...e,[t]:a};try{localStorage.setItem("ptos_ads_group_notes",JSON.stringify(s))}catch(e){}return s})},placeholder:"Group notes",className:"w-44 rounded-md border px-2 py-1 text-sm bg-white"})}return(0,s.jsx)("input",{value:E[r]||"",onChange:e=>{let t=e.target.value;R(e=>{let a={...e,[r]:t};try{localStorage.setItem("ptos_notes",JSON.stringify(a))}catch(e){}return a})},placeholder:"Notes",className:"w-44 rounded-md border px-2 py-1 text-sm bg-white"})})()}),(0,s.jsxs)("td",{className:"px-3 py-2 text-right",children:[(0,s.jsx)("button",{onClick:async()=>{let t=String(e.campaign_id||""),a=eI[String(r)],s=a?(tt||[]).find(e=>String(e.campaign_id||e.name||"")===a):null;e_(!0),ew(!0);try{var l,n,i,d,c,o;if(s&&s.campaign_id){let a=String(s.campaign_id||""),[r,d]=await Promise.all([(0,h.fB)(t,6,eY),(0,h.fB)(a,6,eY)]),c=((null==r?void 0:r.data)||{}).days||[],o=((null==d?void 0:d.data)||{}).days||[],u={};for(let e of c)u[e.date]=!0;for(let e of o)u[e.date]=!0;let x=Object.keys(u).sort().map(e=>{let t=c.find(t=>t.date===e)||{date:e,spend:0,purchases:0,add_to_cart:0},a=o.find(t=>t.date===e)||{date:e,spend:0,purchases:0,add_to_cart:0},s=Number(t.spend||0)+Number(a.spend||0),l=Number(t.purchases||0)+Number(a.purchases||0),n=Number(t.add_to_cart||0)+Number(a.add_to_cart||0);return{date:e,spend:s,purchases:l,cpp:l>0?s/l:null,ctr:null,add_to_cart:n}});eP(x),eC({id:"".concat(t,"+").concat(a),name:"Merged"});let m=H[e.campaign_id||e.name||""],p=m?"product"===m.kind:/^\d+$/.test((e.name||"").trim()),g=p?m?m.id:(e.name||"").trim():void 0,f=!p&&m&&"collection"===m.kind?m.id:void 0,y=[];for(let e of x){let t=e.date,a=e.date,s=0;try{if(g){let e=await (0,h._R)({names:[g],start:t,end:a,include_closed:!0,date_field:"processed"});s=Number(null!==(l=((null==e?void 0:e.data)||{})[g])&&void 0!==l?l:0)}else if(f){let e=await (0,h.ew)({collection_id:f,start:t,end:a,store:A,include_closed:!0,aggregate:"sum_product_orders",date_field:"processed"});s=Number(null!==(i=null===(n=(null==e?void 0:e.data)||{})||void 0===n?void 0:n.count)&&void 0!==i?i:0)}}catch(e){}y.push(s||0)}eO(y)}else{if(!t)return;eC({id:t,name:e.name||""});let a=await (0,h.fB)(t,6,eY),s=((null==a?void 0:a.data)||{}).days||[];eP(s);let l=H[e.campaign_id||e.name||""],n=l?"product"===l.kind:/^\d+$/.test((e.name||"").trim()),r=n?l?l.id:(e.name||"").trim():void 0,i=!n&&l&&"collection"===l.kind?l.id:void 0,u=[];for(let e of s||[]){let t=e.date,a=e.date;try{if(r){let e=await (0,h._R)({names:[r],start:t,end:a,include_closed:!0,date_field:"processed"}),s=null!==(d=((null==e?void 0:e.data)||{})[r])&&void 0!==d?d:0;u.push(Number(s||0))}else if(i){let e=await (0,h.ew)({collection_id:i,start:t,end:a,store:A,include_closed:!0,aggregate:"sum_product_orders",date_field:"processed"}),s=Number(null!==(o=null===(c=(null==e?void 0:e.data)||{})||void 0===c?void 0:c.count)&&void 0!==o?o:0);u.push(Number(s||0))}else u.push(0)}catch(e){u.push(0)}}eO(u)}}finally{ew(!1)}},className:"px-2 py-1 rounded bg-slate-200 hover:bg-slate-300 text-xs",children:"Performance"}),(0,s.jsx)("button",{onClick:()=>{eB(""),eJ({open:!0,campaign:{id:String(e.campaign_id||""),name:e.name||""}})},className:"ml-2 px-2 py-1 rounded bg-blue-100 hover:bg-blue-200 text-blue-700 text-xs",children:"Timeline"}),i&&(0,s.jsx)("button",{onClick:()=>{var e;return e=String(r),void eZ(t=>{let a=t[e];if(!a)return t;let s={...t};delete s[e],delete s[a];try{localStorage.setItem("ptos_ads_merged",JSON.stringify(s))}catch(e){}return s})},className:"ml-2 px-2 py-1 rounded bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs",children:"Unmerge"})]})]}),(()=>{let t=e.campaign_id||e.name||"";H[t];let a=String(e.campaign_id||""),n=!!ea[a],r=!!el[a];if(n){let e=er[a]||[];return(0,s.jsx)("tr",{className:"border-b last:border-b-0",children:(0,s.jsx)("td",{className:"px-3 py-2 bg-slate-50",colSpan:17,children:r?(0,s.jsx)("div",{className:"text-xs text-slate-500",children:"Loading ad sets…"}):(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsxs)("div",{className:"border rounded bg-white",children:[(0,s.jsxs)("div",{className:"grid grid-cols-8 gap-2 px-2 py-1 text-slate-500",children:[(0,s.jsx)("div",{className:"col-span-3",children:"Ad set"}),(0,s.jsx)("div",{className:"text-right",children:"Spend"}),(0,s.jsx)("div",{className:"text-right",children:"Purchases"}),(0,s.jsx)("div",{className:"text-right",children:"CPP"}),(0,s.jsx)("div",{className:"text-right",children:"CTR"}),(0,s.jsx)("div",{className:"text-right",children:"Status"})]}),e.map(e=>{let t="ACTIVE"===(e.status||"").toUpperCase(),n=t?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700",r=String(e.adset_id||""),i=(ed[a]||{})[r],d=!!i&&(i.count||0)>0;return(0,s.jsxs)(l.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-8 gap-2 px-2 py-1 border-t items-center",children:[(0,s.jsxs)("div",{className:"col-span-3 whitespace-nowrap overflow-hidden text-ellipsis flex items-center gap-2",children:[(0,s.jsx)("span",{children:e.name||"-"}),eo[a]?(0,s.jsx)("span",{className:"text-[10px] text-slate-500",children:"loading orders…"}):d?(0,s.jsxs)("button",{onClick:()=>em(e=>({...e,[r]:!e[r]})),className:"text-[10px] px-1 py-0.5 rounded bg-emerald-100 text-emerald-700 border border-emerald-200",children:["Orders ",(null==i?void 0:i.count)||0," ",ex[r]?"▾":"▸"]}):(0,s.jsx)("span",{className:"text-[10px] px-1 py-0.5 rounded bg-slate-100 text-slate-600 border border-slate-200",children:"Orders 0"})]}),(0,s.jsxs)("div",{className:"text-right",children:["$",(e.spend||0).toFixed(2)]}),(0,s.jsx)("div",{className:"text-right",children:e.purchases||0}),(0,s.jsx)("div",{className:"text-right",children:null!=e.cpp?"$".concat(e.cpp.toFixed(2)):"—"}),(0,s.jsx)("div",{className:"text-right",children:null!=e.ctr?"".concat((1*e.ctr).toFixed(2),"%"):"—"}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ".concat(n),children:t?"Active":"Paused"}),r&&(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:t,disabled:!!eg[r],onChange:async e=>{let t=e.target.checked?"ACTIVE":"PAUSED";if(window.confirm("Turn ".concat("ACTIVE"===t?"ON":"OFF"," this ad set?")))try{ef(e=>({...e,[r]:!0})),await (0,h.JM)(r,t),ei(e=>({...e,[a]:(e[a]||[]).map(e=>e.adset_id===r?{...e,status:t}:e)}))}catch(e){alert("Failed to update ad set status")}finally{ef(e=>({...e,[r]:!1}))}},className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-10 h-5 bg-gray-200 rounded-full peer peer-checked:bg-emerald-500 transition-colors",children:(0,s.jsx)("div",{className:"w-4 h-4 bg-white rounded-full shadow transform transition-transform translate-x-0 peer-checked:translate-x-5 mt-0.5 ml-0.5"})})]})]})]}),ex[r]&&d&&(0,s.jsxs)("div",{className:"col-span-8 px-2 py-1 border-t bg-slate-50 text-slate-700",children:[(0,s.jsx)("div",{className:"text-[11px] text-slate-600 mb-1",children:"Attributed Shopify orders (by UTM ad_id)"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-xs",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-left text-slate-500",children:[(0,s.jsx)("th",{className:"px-1 py-1",children:"Order"}),(0,s.jsx)("th",{className:"px-1 py-1",children:"Processed"}),(0,s.jsx)("th",{className:"px-1 py-1",children:"Total"}),(0,s.jsx)("th",{className:"px-1 py-1",children:"ad_id"}),(0,s.jsx)("th",{className:"px-1 py-1",children:"utm_campaign"}),(0,s.jsx)("th",{className:"px-1 py-1",children:"utm_source"}),(0,s.jsx)("th",{className:"px-1 py-1",children:"utm_medium"})]})}),(0,s.jsx)("tbody",{children:((null==i?void 0:i.orders)||[]).map((e,t)=>(0,s.jsxs)("tr",{className:"border-t",children:[(0,s.jsx)("td",{className:"px-1 py-1 font-mono",children:String(e.order_id||"")}),(0,s.jsx)("td",{className:"px-1 py-1",children:(e.processed_at||"").replace("T"," ").replace("Z","")}),(0,s.jsx)("td",{className:"px-1 py-1",children:"number"==typeof e.total_price?"$".concat((e.total_price||0).toFixed(2)):"-"}),(0,s.jsx)("td",{className:"px-1 py-1",children:e.ad_id||(e.utm||{}).ad_id||""}),(0,s.jsx)("td",{className:"px-1 py-1",children:(e.utm||{}).utm_campaign||e.campaign_id||""}),(0,s.jsx)("td",{className:"px-1 py-1",children:(e.utm||{}).utm_source||""}),(0,s.jsx)("td",{className:"px-1 py-1",children:(e.utm||{}).utm_medium||""})]},String(e.order_id||t)))})]})})]})]},r||e.name)}),0===e.length&&(0,s.jsx)("div",{className:"px-2 py-2 text-slate-500 border-t",children:"No ad sets found."})]})})})})}let i=H[t];if(!(i&&"collection"===i.kind&&Y[String(t)]))return null;let d=Q[String(t)]||[],c=X[String(t)]||{},o=!!ee[String(t)];return(0,s.jsx)("tr",{className:"border-b last:border-b-0",children:(0,s.jsx)("td",{className:"px-3 py-2 bg-slate-50",colSpan:15,children:o?(0,s.jsx)("div",{className:"text-xs text-slate-500",children:"Loading products…"}):(0,s.jsx)("div",{className:"text-xs",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:[d.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex items-center justify-between border rounded px-2 py-1 bg-white",children:[(0,s.jsx)("span",{className:"font-mono",children:e}),(0,s.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full bg-emerald-100 text-emerald-700 font-semibold",children:null!==(t=c[e])&&void 0!==t?t:"—"})]},e)}),0===d.length&&(0,s.jsx)("div",{className:"text-slate-500",children:"No products in this collection."})]})})})})})()]},e.campaign_id||e.name)})]})]})})]}),(0,s.jsx)(y,{open:eN,onClose:()=>e_(!1),loading:eS,campaign:ek,days:eM,orders:eA}),(0,s.jsx)(f,{open:eH.open,onClose:()=>eJ({open:!1}),campaign:eH.campaign||null,meta:eH.campaign&&eE[String(eH.campaign.id||eH.campaign.name||"")]||void 0,draft:eq,setDraft:eB,adding:eU,onAdd:async e=>{if(!eH.campaign)return;let t=String(eH.campaign.id||eH.campaign.name||"");try{eV(!0),await (0,h.hs)({campaign_key:t,text:e,store:A}),eB("");try{let e=await (0,h.u1)(A);eR((null==e?void 0:e.data)||{})}catch(e){}}finally{eV(!1)}}})]})}function f(e){let{open:t,onClose:a,campaign:l,meta:n,onAdd:r,adding:i,draft:d,setDraft:c}=e;if(!t)return null;let o=((null==n?void 0:n.timeline)||[]).slice().sort((e,t)=>String(e.at||"").localeCompare(String(t.at||"")));return(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:a}),(0,s.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-[92vw] max-w-2xl max-h-[90vh] overflow-auto",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"font-semibold text-lg",children:["Timeline \xb7 ",(null==l?void 0:l.name)||(null==l?void 0:l.id)]}),(0,s.jsx)("button",{onClick:a,className:"px-2 py-1 rounded bg-slate-100 hover:bg-slate-200",children:"Close"})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{value:d,onChange:e=>c(e.target.value),placeholder:"Add a note",className:"flex-1 rounded-md border px-3 py-2 text-sm bg-white"}),(0,s.jsx)("button",{onClick:async()=>{d.trim()&&await r(d.trim())},disabled:i||!d.trim(),className:"px-3 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white text-sm disabled:opacity-60",children:i?"Adding…":"Add"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[o.map((e,t)=>{let a=t>0?o[t-1]:void 0;return(0,s.jsxs)("div",{className:"border rounded p-3 bg-slate-50",children:[(0,s.jsxs)("div",{className:"text-xs text-slate-500 flex items-center justify-between",children:[(0,s.jsx)("span",{children:String(e.at||"").replace("T"," ").replace("Z","")}),(0,s.jsx)("span",{className:"font-mono",children:function(e,t){if(!e)return"—";try{let a=new Date(e).getTime(),s=new Date(t).getTime(),l=Math.max(0,s-a),n=Math.floor(l/864e5);l-=864e5*n;let r=Math.floor(l/36e5);l-=36e5*r;let i=Math.floor(l/6e4),d=[];return n&&d.push("".concat(n,"d")),r&&d.push("".concat(r,"h")),d.push("".concat(i,"m")),d.join(" ")}catch(e){return"—"}}(null==a?void 0:a.at,e.at||"")})]}),(0,s.jsx)("div",{className:"mt-2 text-sm text-slate-800 whitespace-pre-wrap",children:e.text||""})]},String(e.at||t))}),0===o.length&&(0,s.jsx)("div",{className:"text-sm text-slate-500",children:"No notes yet."})]})]})]})]})}function y(e){let{open:t,onClose:a,loading:n,campaign:r,days:i,orders:d}=e;if(!t)return null;let c=(i||[]).map(e=>e.date),o=(i||[]).map(e=>e.spend||0);(i||[]).map(e=>e.purchases||0),(i||[]).map(e=>1*(e.ctr||0)),(i||[]).map(e=>null==e.cpp?0:e.cpp||0);let u=(i||[]).map(e=>e.add_to_cart||0),x=d||[],m=(i||[]).map((e,t)=>{let a=Number(x[t]||0),s=Number(e.spend||0);return a>0?s/a:0}),[p,h]=(0,l.useState)(!0),[g,f]=(0,l.useState)(!0);return(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:a}),(0,s.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-[92vw] max-w-5xl max-h-[90vh] overflow-auto",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"font-semibold text-lg",children:["Performance \xb7 ",(null==r?void 0:r.name)||(null==r?void 0:r.id)]}),(0,s.jsx)("button",{onClick:a,className:"px-2 py-1 rounded bg-slate-100 hover:bg-slate-200",children:"Close"})]}),(0,s.jsx)("div",{className:"p-4",children:n?(0,s.jsx)("div",{className:"text-slate-500",children:"Loading…"}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,s.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:p,onChange:e=>h(e.target.checked)}),(0,s.jsx)("span",{children:"Show Orders"})]}),(0,s.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:g,onChange:e=>f(e.target.checked)}),(0,s.jsx)("span",{children:"Show Add to cart"})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:(i||[]).map((e,t)=>(0,s.jsxs)("div",{className:"border rounded p-3 bg-slate-50",children:[(0,s.jsx)("div",{className:"text-xs text-slate-500",children:e.date}),(0,s.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-3 gap-y-1 text-sm",children:[(0,s.jsx)("div",{className:"text-slate-500",children:"Spend"}),(0,s.jsxs)("div",{className:"text-right font-semibold",children:["$",(e.spend||0).toFixed(2)]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Purchases"}),(0,s.jsx)("div",{className:"text-right font-semibold",children:e.purchases||0}),(0,s.jsx)("div",{className:"text-slate-500",children:"CPP"}),(0,s.jsx)("div",{className:"text-right font-semibold",children:null!=e.cpp?"$".concat((e.cpp||0).toFixed(2)):"—"}),(0,s.jsx)("div",{className:"text-slate-500",children:"CTR"}),(0,s.jsx)("div",{className:"text-right font-semibold",children:null!=e.ctr?"".concat((1*e.ctr).toFixed(2),"%"):"—"}),(0,s.jsx)("div",{className:"text-slate-500",children:"Add to cart"}),(0,s.jsx)("div",{className:"text-right font-semibold",children:e.add_to_cart||0}),(0,s.jsx)("div",{className:"text-slate-500",children:"Shopify Orders"}),(0,s.jsx)("div",{className:"text-right font-semibold",children:x[t]||0}),(0,s.jsx)("div",{className:"text-slate-500",children:"True CPP"}),(0,s.jsx)("div",{className:"text-right font-semibold",children:(x[t]||0)>0?"$".concat((m[t]||0).toFixed(2)):"—"})]})]},e.date+String(t)))}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"mb-2 text-sm text-slate-600",children:"Daily performance (Spend/True CPP lines, Orders/ATC lines)"}),(0,s.jsx)(b,{labels:c,spend:o,trueCpp:m,orders:x,addToCart:u,showOrders:p,showATC:g})]})]})})]})]})}function b(e){let{labels:t,spend:a,trueCpp:l,orders:n,addToCart:r,showOrders:i,showATC:d}=e,c=Math.max(1,t.length),o=t.map((e,t)=>56+888*t/Math.max(1,c-1)),u=Math.max(25,25*Math.ceil(Math.max(1,...a.map(e=>Number(e||0)),...l.map(e=>Number(e||0)))/25)),x=(e,t,a)=>Math.max(t,Math.min(a,e||0)),m=e=>280-(x(e,0,u)-0)/(u-0)*256,p=e=>280-(x(e,1,100)-1)/99*256,h=[0,.25,.5,.75,1].map(e=>Math.round(e*u)),g="M ".concat(o[0],",").concat(m(a[0]||0)," ")+a.slice(1).map((e,t)=>"L ".concat(o[t+1],",").concat(m(e||0))).join(" "),f="M ".concat(o[0],",").concat(m(l[0]||0)," ")+l.slice(1).map((e,t)=>"L ".concat(o[t+1],",").concat(m(e||0))).join(" "),y="M ".concat(o[0],",").concat(p(n[0]||0)," ")+n.slice(1).map((e,t)=>"L ".concat(o[t+1],",").concat(p(e||0))).join(" "),b="M ".concat(o[0],",").concat(p(r[0]||0)," ")+r.slice(1).map((e,t)=>"L ".concat(o[t+1],",").concat(p(e||0))).join(" ");return(0,s.jsxs)("svg",{viewBox:"0 0 ".concat(1e3," ").concat(320),className:"w-full h-auto",children:[(0,s.jsx)("rect",{x:0,y:0,width:1e3,height:320,fill:"#ffffff"}),h.map((e,t)=>(0,s.jsx)("line",{x1:56,y1:m(e),x2:944,y2:m(e),stroke:"#e5e7eb",strokeDasharray:"2 2"},"h".concat(t))),o.map((e,t)=>(0,s.jsx)("line",{x1:e,y1:24,x2:e,y2:280,stroke:"#f1f5f9"},"v".concat(t))),(0,s.jsx)("path",{d:g,fill:"none",stroke:"#10b981",strokeWidth:2.5}),(0,s.jsx)("path",{d:f,fill:"none",stroke:"#7c3aed",strokeWidth:2.5}),i&&(0,s.jsx)("path",{d:y,fill:"none",stroke:"#2563eb",strokeWidth:2.5}),d&&(0,s.jsx)("path",{d:b,fill:"none",stroke:"#f59e0b",strokeWidth:2.5}),h.map((e,t)=>(0,s.jsxs)("text",{x:48,y:m(e),textAnchor:"end",alignmentBaseline:"middle",fontSize:"10",fill:"#64748b",children:["$",e]},"lt".concat(t))),[1,25,50,75,100].map((e,t)=>(0,s.jsx)("text",{x:952,y:p(e),textAnchor:"start",alignmentBaseline:"middle",fontSize:"10",fill:"#64748b",children:e},"rt".concat(t))),o.map((e,a)=>(0,s.jsx)("text",{x:e,y:310,textAnchor:"middle",fontSize:"10",fill:"#64748b",children:t[a].slice(5)},"x".concat(a))),o.map((e,t)=>(0,s.jsxs)("g",{children:[(0,s.jsx)("circle",{cx:e,cy:m(l[t]||0),r:3,fill:"#7c3aed"}),(l[t]||0)>0&&(0,s.jsxs)("text",{x:e,y:m(l[t]||0)-8,textAnchor:"middle",fontSize:"10",fill:"#7c3aed",children:["$",(l[t]||0).toFixed(2)]})]},"tc".concat(t))),(0,s.jsxs)("g",{children:[(0,s.jsx)("rect",{x:56,y:8,width:18,height:2,fill:"#10b981"}),(0,s.jsx)("text",{x:80,y:12,fontSize:"11",fill:"#334155",children:"Spend ($)"}),(0,s.jsx)("rect",{x:176,y:8,width:18,height:2,fill:"#7c3aed"}),(0,s.jsx)("text",{x:202,y:12,fontSize:"11",fill:"#334155",children:"True CPP ($)"}),(0,s.jsx)("rect",{x:316,y:8,width:18,height:2,fill:"#2563eb"}),(0,s.jsx)("text",{x:342,y:12,fontSize:"11",fill:"#334155",children:"Orders"}),(0,s.jsx)("rect",{x:416,y:8,width:18,height:2,fill:"#f59e0b"}),(0,s.jsx)("text",{x:442,y:12,fontSize:"11",fill:"#334155",children:"Add to cart"})]})]})}},3541:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},1077:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},6706:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},2757:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},7138:function(e,t,a){"use strict";a.d(t,{default:function(){return l.a}});var s=a(231),l=a.n(s)}},function(e){e.O(0,[472,231,264,971,23,744],function(){return e(e.s=9541)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[809],{8158:function(e,t,a){Promise.resolve().then(a.bind(a,7860))},7860:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7437),l=a(2265),r=a(7138),n=a(2757),i=a(9061),d=a(6706),c=a(1077),o=a(3541),u=a(6264);function x(e){let t=Number(e||0);try{return t.toLocaleString(void 0,{style:"currency",currency:"MAD",maximumFractionDigits:2})}catch(e){return"".concat(t.toFixed(2)," MAD")}}function p(e){let t=String(e||"").trim();return t?t.toLowerCase().startsWith("act_")?t.split("_",2)[1]||"":t:""}function m(e){let t=new Date,a=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)},s=new Date(t),l=new Date(t);switch(e){case"today":l.setHours(0,0,0,0);break;case"yesterday":{let e=new Date(t);e.setDate(e.getDate()-1),e.setHours(0,0,0,0);let s=new Date(e);return s.setHours(23,59,59,999),{start:a(e),end:a(s)}}case"last_3d_incl_today":l.setDate(l.getDate()-2);break;case"last_4d_incl_today":l.setDate(l.getDate()-3);break;case"last_5d_incl_today":l.setDate(l.getDate()-4);break;case"last_6d_incl_today":l.setDate(l.getDate()-5);break;default:l.setDate(l.getDate()-6)}return l.setHours(0,0,0,0),{start:a(l),end:a(s)}}function h(){let[e,t]=(0,l.useState)(()=>{try{return localStorage.getItem("ptos_store")||"irrakids"}catch(e){return"irrakids"}}),[a,h]=(0,l.useState)(()=>{try{return p(localStorage.getItem("ptos_ad_account")||"")}catch(e){return""}}),[g,v]=(0,l.useState)(""),[y,f]=(0,l.useState)([]),[b,_]=(0,l.useState)("last_7d_incl_today"),[j,N]=(0,l.useState)(""),[w,S]=(0,l.useState)(""),[k,C]=(0,l.useState)(!1),[M,D]=(0,l.useState)(void 0),[A,Z]=(0,l.useState)(10),[I,L]=(0,l.useState)("10"),[P,E]=(0,l.useState)(!1),[O,H]=(0,l.useState)([]),[U,z]=(0,l.useState)({}),[R,T]=(0,l.useState)({}),[q,J]=(0,l.useState)({}),[V,F]=(0,l.useState)({}),[B,Y]=(0,l.useState)(()=>{try{return JSON.parse(localStorage.getItem("ptos_profit_selected")||"{}")}catch(e){return{}}}),[W,X]=(0,l.useState)(()=>{try{return JSON.parse(localStorage.getItem("ptos_profit_merged")||"{}")}catch(e){return{}}}),[$,G]=(0,l.useState)({}),[K,Q]=(0,l.useState)({}),[ee,et]=(0,l.useState)({}),ea=(0,l.useRef)(0);function es(e,t){try{var a,s;let l=String((null==e?void 0:null===(a=e.range)||void 0===a?void 0:a.start)||""),r=String((null==e?void 0:null===(s=e.range)||void 0===s?void 0:s.end)||"");return!!e&&l===t.start&&r===t.end}catch(e){return!1}}function el(e){let t=String(e.campaign_id||"").trim(),a=String(e.name||"").trim(),s=t&&U[t]&&"product"===U[t].kind?U[t].id:a&&U[a]&&"product"===U[a].kind?U[a].id:null;return s&&/^\d+$/.test(s)?s:function(e){let t=String(e||"").match(/(\d{3,})/);return t?t[1]:null}(a)}async function er(){let t=++ea.current;C(!0),D(void 0);try{let s=function(e){if("custom"===e){if(j&&w)return{range:{start:j,end:w}};let{start:e,end:t}=m("last_7d_incl_today");return{range:{start:e,end:t}}}if("last_3d_incl_today"===e||"last_4d_incl_today"===e||"last_5d_incl_today"===e||"last_6d_incl_today"===e||"last_7d_incl_today"===e){let{start:t,end:a}=m(e);return{range:{start:t,end:a}}}if("today"===e)return{datePreset:"today"};if("yesterday"===e)return{datePreset:"yesterday"};let{start:t,end:a}=m("last_7d_incl_today");return{range:{start:t,end:a}}}(b),l=await (0,u._X)(s.datePreset,a||void 0,s.range);if(t!==ea.current)return;if(null==l?void 0:l.error)throw Error(String(l.error));let r=((null==l?void 0:l.data)||[]).filter(e=>Number(e.spend||0)>0);H(r),G(e=>{let t={...e};for(let e of r){let a=String(e.campaign_id||"");a&&!t[a]&&(t[a]=b)}return t}),"custom"===b&&j&&w&&Q(e=>{let t={...e};for(let e of r){let a=String(e.campaign_id||"");a&&!t[a]&&(t[a]={start:j,end:w})}return t});try{let a=await (0,u.zO)(e);if(t!==ea.current)return;z((null==a?void 0:a.data)||{})}catch(e){}try{let s=await (0,u.Iy)({store:e,ad_account:a||void 0});if(t!==ea.current)return;J((null==s?void 0:s.data)||{})}catch(e){J({})}try{let a=await (0,u.WT)(e);if(t!==ea.current)return;F((null==a?void 0:a.data)||{})}catch(e){F({})}let n=[],i={};for(let e of r){let t=el(e);t&&!i[t]&&(i[t]=!0,n.push(t))}if(n.length)try{let a=await (0,u.$8)({ids:n,store:e});if(t!==ea.current)return;T((null==a?void 0:a.data)||{})}catch(e){T({})}else T({})}catch(e){D(String((null==e?void 0:e.message)||e)),H([])}finally{t===ea.current&&C(!1)}}(0,l.useEffect)(()=>{let{start:e,end:t}=m("last_7d_incl_today");N(e),S(t)},[]),(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,u.C4)();f((null==e?void 0:e.data)||[])}catch(e){f([])}})()},[]),(0,l.useEffect)(()=>{let t=!1;return(async()=>{try{let l=await (0,u.M5)(e);if(!t){var a,s;let e=Number(null!==(s=null===(a=(null==l?void 0:l.data)||{})||void 0===a?void 0:a.rate)&&void 0!==s?s:10);Z(e),L(String(e))}}catch(e){}try{let a=await (0,u.gc)(e);if(t)return;let s=(null==a?void 0:a.data)||{},l=s&&s.id?String(s.id||""):"",r=p(l),n=s&&s.name?String(s.name||""):"";if(r){h(r);try{localStorage.setItem("ptos_ad_account",r)}catch(e){}}v(n||"")}catch(e){if(t)return;v("")}})(),()=>{t=!0}},[e]),(0,l.useEffect)(()=>{a&&er()},[e,a,b,j,w]);let en=(0,l.useMemo)(()=>{let e=(O||[]).slice().sort((e,t)=>Number(t.spend||0)-Number(e.spend||0)),t={};for(let a of e)t[String(a.campaign_id||"")]=a;let a={},s=[];for(let l of e){let e=String(l.campaign_id||"");if(a[e])continue;let r=W[e];r&&t[r]?(s.push(l),s.push(t[r]),a[e]=!0,a[r]=!0):(s.push(l),a[e]=!0)}return s},[O,W]),ei=(0,l.useMemo)(()=>{let e={};for(let a=0;a<(en||[]).length;a++){var t;e[String((null===(t=en[a])||void 0===t?void 0:t.campaign_id)||"")]=a}return e},[en]),ed=(0,l.useMemo)(()=>{let e=0;for(let t of O||[])e+=Number(t.spend||0)*Number(A||10);return e},[O,A]);async function ec(t,s,l){let r=Array.from(new Set(t.filter(Boolean)));if(r.length){et(e=>{let t={...e};for(let e of r)t[e]=!0;return t});try{let t=await Promise.all(r.map(t=>(0,u.V0)({campaign_id:t,start:s.start,end:s.end,store:e,ad_account:a,force:!!l}))),n={};for(let e of t){if(null==e?void 0:e.error)throw Error(String(e.error));let t=null==e?void 0:e.data;(null==t?void 0:t.campaign_id)&&(n[String(t.campaign_id)]=t)}J(e=>({...e,...n}))}finally{et(e=>{let t={...e};for(let e of r)t[e]=!1;return t})}}}return(0,s.jsxs)("div",{className:"min-h-screen w-full bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-sky-50 via-white to-indigo-50 text-slate-800",children:[(0,s.jsxs)("header",{className:"min-h-16 py-2 px-4 md:px-6 flex items-center justify-between border-b bg-white/70 backdrop-blur sticky top-0 z-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(n.Z,{className:"w-6 h-6 text-emerald-600"}),(0,s.jsx)("h1",{className:"font-semibold text-lg",children:"Profit calculator"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[(0,s.jsxs)("select",{value:e,onChange:e=>{let a=e.target.value;t(a);try{localStorage.setItem("ptos_store",a)}catch(e){}},className:"rounded-xl border px-2 py-1 text-sm bg-white",children:[(0,s.jsx)("option",{value:"irrakids",children:"irrakids"}),(0,s.jsx)("option",{value:"irranova",children:"irranova"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("select",{value:a,onChange:async t=>{let a=p(t.target.value);h(a);try{localStorage.setItem("ptos_ad_account",a)}catch(e){}try{var s;let t=await (0,u.UI)({id:a,store:e}),l=(null==t?void 0:t.data)||{};v(String((null==l?void 0:l.name)||(null===(s=y.find(e=>p(e.id)===a))||void 0===s?void 0:s.name)||""))}catch(e){}},className:"rounded-xl border px-2 py-1 text-sm bg-white w-44 sm:w-56 md:w-72",children:[(0,s.jsx)("option",{value:"",children:"Select ad account…"}),y.map(e=>(0,s.jsxs)("option",{value:p(e.id),children:[e.name||e.id," (",p(e.id),")"]},e.id))]}),g?(0,s.jsx)("span",{className:"text-xs text-slate-600",children:g}):null]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("select",{value:b,onChange:e=>_(e.target.value),className:"rounded-xl border px-2 py-1 text-sm bg-white",children:[(0,s.jsx)("option",{value:"today",children:"Today"}),(0,s.jsx)("option",{value:"yesterday",children:"Yesterday"}),(0,s.jsx)("option",{value:"last_3d_incl_today",children:"Last 3 days (including today)"}),(0,s.jsx)("option",{value:"last_4d_incl_today",children:"Last 4 days (including today)"}),(0,s.jsx)("option",{value:"last_5d_incl_today",children:"Last 5 days (including today)"}),(0,s.jsx)("option",{value:"last_6d_incl_today",children:"Last 6 days (including today)"}),(0,s.jsx)("option",{value:"last_7d_incl_today",children:"Last 7 days (including today)"}),(0,s.jsx)("option",{value:"custom",children:"Custom…"})]}),"custom"===b&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,s.jsx)("input",{type:"date",value:j,onChange:e=>N(e.target.value),className:"rounded-xl border px-2 py-1 bg-white"}),(0,s.jsx)("span",{children:"to"}),(0,s.jsx)("input",{type:"date",value:w,onChange:e=>S(e.target.value),className:"rounded-xl border px-2 py-1 bg-white"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs text-slate-600",children:"USD→MAD"}),(0,s.jsx)("input",{className:"w-24 rounded-xl border px-2 py-1 text-sm bg-white",value:I,onChange:e=>L(e.target.value),inputMode:"decimal"}),(0,s.jsxs)("button",{onClick:async()=>{let t=Number(I||0)||10;E(!0);try{var a,s;let l=await (0,u.aX)({rate:t,store:e});if(null==l?void 0:l.error)throw Error(String(l.error));let r=Number(null!==(s=null===(a=(null==l?void 0:l.data)||{})||void 0===a?void 0:a.rate)&&void 0!==s?s:t);Z(r),L(String(r))}catch(e){}finally{E(!1)}},disabled:P,className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-slate-200 hover:bg-slate-300 text-slate-900 text-sm disabled:opacity-60",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4"})," ",P?"Saving…":"Save rate"]})]}),(0,s.jsxs)("button",{onClick:er,className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white text-sm disabled:opacity-60",disabled:k,children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 ".concat(k?"animate-spin":"")})," ",k?"Updating…":"Refresh"]}),(0,s.jsx)(r.default,{href:"/",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:"Home"})]})]}),(0,s.jsxs)("div",{className:"p-4 md:p-6",children:[M&&(0,s.jsx)("div",{className:"mb-3 text-sm text-red-600",children:M}),(0,s.jsx)("div",{className:"mb-4 rounded-2xl overflow-hidden shadow-lg bg-gradient-to-r from-emerald-600 via-green-600 to-lime-500 text-white",children:(0,s.jsxs)("div",{className:"p-4 md:p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-xs uppercase/relaxed opacity-80",children:"Ad account"}),(0,s.jsx)("div",{className:"text-lg font-semibold",children:g||a||"—"}),(0,s.jsxs)("div",{className:"text-xs opacity-80",children:["Range: ","custom"===b?"".concat(j||"—"," to ").concat(w||"—"):function(e){switch(e){case"today":return"today";case"yesterday":return"yesterday";case"last_3d_incl_today":return"last 3 days (including today)";case"last_4d_incl_today":return"last 4 days (including today)";case"last_5d_incl_today":return"last 5 days (including today)";case"last_6d_incl_today":return"last 6 days (including today)";case"last_7d_incl_today":return"last 7 days (including today)";case"custom":return"custom";default:return e}}(b)," • Store: ",e]})]}),(0,s.jsxs)("div",{className:"text-sm opacity-90 flex items-center gap-2",children:[(0,s.jsx)(c.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Profit overview"})]})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsx)("div",{className:"text-xs opacity-90",children:"Campaigns with spend"}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:(O||[]).length})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20",children:[(0,s.jsx)("div",{className:"text-xs opacity-90",children:"Spend (MAD)"}),(0,s.jsx)("div",{className:"mt-1 text-xl font-bold",children:x(ed)})]})]})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600",children:"Select 2 rows to merge (use combined spend for net profit)."}),(0,s.jsx)("button",{onClick:function(){let e=Object.keys(B).filter(e=>!!B[e]);if(2!==e.length){alert("Select exactly 2 rows to merge.");return}let[t,a]=e;X(e=>{let s={...e},l=s[t],r=s[a];l&&(delete s[l],delete s[t]),r&&(delete s[r],delete s[a]),s[t]=a,s[a]=t;try{localStorage.setItem("ptos_profit_merged",JSON.stringify(s))}catch(e){}return s}),Y(()=>{try{localStorage.setItem("ptos_profit_selected","{}")}catch(e){}return{}})},className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-sm disabled:opacity-60",disabled:2!==Object.keys(B).filter(e=>B[e]).length,children:"Merge 2"})]}),(0,s.jsx)("div",{className:"overflow-x-auto bg-white border rounded-none",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-slate-50/90 backdrop-blur supports-backdrop-blur:bg-slate-50/60 border-b shadow-sm",children:(0,s.jsxs)("tr",{className:"text-left",children:[(0,s.jsx)("th",{className:"px-3 py-2 font-semibold w-8",children:"Sel"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:"Product"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:"Campaign"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold",children:"Status"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Spend (MAD)"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Shopify Orders"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Paid Orders"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Product price (MAD)"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Inventory"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Product cost (per paid order)"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Service + delivery (per paid order)"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Net profit (MAD)"}),(0,s.jsx)("th",{className:"px-3 py-2 font-semibold text-right",children:"Actions"})]})}),(0,s.jsxs)("tbody",{children:[k&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:13,className:"px-3 py-6 text-center text-slate-500",children:"Loading…"})}),!k&&0===en.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:13,className:"px-3 py-6 text-center text-slate-500",children:"No campaigns with spend in this range."})}),!k&&en.map(t=>{var l,r,n,i,c,p,h,g,v,y,f,_,N,S,k,C,M,A,Z,I,L,P,E,O,H,U;let z=String(t.campaign_id||""),T=W[z],et=T?en.find(e=>String(e.campaign_id||"")===T):void 0,ea=!!T&&!!et,er=!!ea&&Number(null!==(N=ei[T])&&void 0!==N?N:-1)<Number(null!==(S=ei[z])&&void 0!==S?S:-1),ed=function(e){let t=$[e]||b;if("custom"===t){let t=K[e],a=(null==t?void 0:t.start)||j,s=(null==t?void 0:t.end)||w;return a&&s?{start:a,end:s}:m("last_7d_incl_today")}return m(t)}(z),eo=(es(q[z],ed)&&Number((null===(l=q[z])||void 0===l?void 0:l.spend_mad)||0)||0)+(et&&es(q[String(et.campaign_id||"")],ed)&&Number((null===(r=q[String(et.campaign_id||"")])||void 0===r?void 0:r.spend_mad)||0)||0),eu=q[z],ex=(null==eu?void 0:null===(n=eu.product)||void 0===n?void 0:n.id)||el(t),ep=ex?null===(i=R[ex])||void 0===i?void 0:i.image:null,em=ex&&V[ex]||{},eh=Number(null!==(M=null!==(C=em.product_cost)&&void 0!==C?C:null!==(k=null==eu?void 0:null===(c=eu.costs)||void 0===c?void 0:c.product_cost)&&void 0!==k?k:0)&&void 0!==M?M:0),eg=Number(null!==(I=null!==(Z=em.service_delivery_cost)&&void 0!==Z?Z:null!==(A=null==eu?void 0:null===(p=eu.costs)||void 0===p?void 0:p.service_delivery_cost)&&void 0!==A?A:0)&&void 0!==I?I:0),ev=es(eu,ed),ey=ev?Number(null!==(L=null==eu?void 0:null===(h=eu.shopify)||void 0===h?void 0:h.paid_orders_total)&&void 0!==L?L:0):0,ef=ev?Number(null!==(P=null==eu?void 0:null===(g=eu.shopify)||void 0===g?void 0:g.orders_total)&&void 0!==P?P:0):0,eb=ev?Number(null!==(E=null==eu?void 0:null===(v=eu.product)||void 0===v?void 0:v.price_mad)&&void 0!==E?E:0):0,e_=ev?null==eu?void 0:null===(y=eu.product)||void 0===y?void 0:y.inventory:void 0,ej=ev?Number(null!==(O=null==eu?void 0:eu.profit_per_paid_order_mad)&&void 0!==O?O:eb-eh-eg):0,eN=er?0:ea?eo:ev?Number((null==eu?void 0:eu.spend_mad)||0):0,ew=ev&&!er?ej*ey-eN:0,eS="ACTIVE"===String(t.status||"").toUpperCase(),ek=eS?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700",eC=$[z]||b,eM=!!ee[z];if(er){let e=et?String(et.campaign_id||""):T,a=(null==et?void 0:et.name)||e||T;return(0,s.jsxs)("tr",{className:"border-b last:border-b-0 bg-slate-50/40",children:[(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsx)("input",{type:"checkbox",checked:!1,disabled:!0})}),(0,s.jsx)("td",{className:"px-3 py-2",children:ep?(0,s.jsx)("img",{src:ep,alt:"product",className:"w-16 h-16 rounded object-cover border"}):(0,s.jsx)("div",{className:"w-16 h-16 rounded border bg-slate-50"})}),(0,s.jsxs)("td",{className:"px-3 py-2 whitespace-nowrap",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded bg-purple-100 text-purple-800 text-xs font-semibold",children:["merged ",(0,s.jsx)(o.Z,{className:"w-3 h-3"})]}),(0,s.jsx)("span",{className:"text-slate-700",children:t.name||"-"})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-500",children:["Merged into: ",a]})]}),(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ".concat(ek),children:eS?"Active":"Paused"})}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:(0,s.jsx)("input",{type:"number",step:"0.01",disabled:!0,value:"",className:"w-28 rounded-md border px-2 py-1 text-sm bg-slate-50"})}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:(0,s.jsx)("input",{type:"number",step:"0.01",disabled:!0,value:"",className:"w-36 rounded-md border px-2 py-1 text-sm bg-slate-50"})}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right"})]},z||t.name)}return(0,s.jsxs)("tr",{className:"border-b last:border-b-0",children:[(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsx)("input",{type:"checkbox",checked:!!B[z],onChange:e=>{var t;return t=e.target.checked,void Y(e=>{let a={...e,[z]:null==t?!e[z]:!!t};try{localStorage.setItem("ptos_profit_selected",JSON.stringify(a))}catch(e){}return a})}})}),(0,s.jsx)("td",{className:"px-3 py-2",children:ep?(0,s.jsx)("img",{src:ep,alt:"product",className:"w-16 h-16 rounded object-cover border"}):(0,s.jsx)("div",{className:"w-16 h-16 rounded border bg-slate-50"})}),(0,s.jsxs)("td",{className:"px-3 py-2 whitespace-nowrap",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[ea?(0,s.jsx)("button",{onClick:()=>{X(e=>{let t=e[z];if(!t)return e;let a={...e};delete a[z],delete a[t];try{localStorage.setItem("ptos_profit_merged",JSON.stringify(a))}catch(e){}return a})},className:"px-2 py-0.5 rounded bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs",children:"Unmerge"}):null,(0,s.jsx)("span",{children:t.name||"-"})]}),et?(0,s.jsxs)("div",{className:"text-xs text-slate-500",children:["Merged with: ",et.name||et.campaign_id]}):null]}),(0,s.jsx)("td",{className:"px-3 py-2",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ".concat(ek),children:eS?"Active":"Paused"})}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:ev?x(eN):"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:ev?ef:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:ev?ey:"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:ev?x(eb):"—"}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:ev&&null!=e_?e_:"—"}),(0,s.jsxs)("td",{className:"px-3 py-2 text-right",children:[(0,s.jsx)("input",{type:"number",step:"0.01",disabled:!ex,value:ex?String(null!==(H=em.product_cost)&&void 0!==H?H:""):"",onChange:e=>{if(!ex)return;let t=""===e.target.value?null:Number(e.target.value);F(e=>({...e,[ex]:{...e[ex]||{},product_cost:t}}))},onBlur:async()=>{if(!ex)return;let t=V[ex]||{};try{var a;await (0,u.cU)({product_id:ex,product_cost:null!==(a=t.product_cost)&&void 0!==a?a:null,store:e})}catch(e){}},className:"w-28 rounded-md border px-2 py-1 text-sm bg-white disabled:bg-slate-50"}),ev?(0,s.jsxs)("div",{className:"mt-1 text-[11px] text-slate-500",children:["Total: ",x((eh||0)*(ey||0))]}):null]}),(0,s.jsxs)("td",{className:"px-3 py-2 text-right",children:[(0,s.jsx)("input",{type:"number",step:"0.01",disabled:!ex,value:ex?String(null!==(U=em.service_delivery_cost)&&void 0!==U?U:""):"",onChange:e=>{if(!ex)return;let t=""===e.target.value?null:Number(e.target.value);F(e=>({...e,[ex]:{...e[ex]||{},service_delivery_cost:t}}))},onBlur:async()=>{if(!ex)return;let t=V[ex]||{};try{var a;await (0,u.cU)({product_id:ex,service_delivery_cost:null!==(a=t.service_delivery_cost)&&void 0!==a?a:null,store:e})}catch(e){}},className:"w-36 rounded-md border px-2 py-1 text-sm bg-white disabled:bg-slate-50"}),ev?(0,s.jsxs)("div",{className:"mt-1 text-[11px] text-slate-500",children:["Total: ",x((eg||0)*(ey||0))]}):null]}),(0,s.jsx)("td",{className:"px-3 py-2 text-right",children:ev?(0,s.jsxs)("button",{className:"w-full min-w-44 inline-flex items-center justify-center gap-2 px-3 py-2 rounded-xl text-white font-bold ".concat(ew>=0?"bg-emerald-600 hover:bg-emerald-700":"bg-rose-600 hover:bg-rose-700"),disabled:!0,children:[(0,s.jsx)("span",{className:"text-white/90",children:"MAD"}),(0,s.jsx)("span",{children:Number(ew||0).toFixed(2)})]}):"—"}),(0,s.jsxs)("td",{className:"px-3 py-2 text-right",children:[(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsxs)("select",{value:eC,onChange:e=>{let t=e.target.value;G(e=>({...e,[z]:t})),"custom"===t&&Q(e=>({...e,[z]:e[z]||{start:j,end:w}}))},className:"rounded-xl border px-2 py-1 text-xs bg-white",children:[(0,s.jsx)("option",{value:"today",children:"Today"}),(0,s.jsx)("option",{value:"yesterday",children:"Yesterday"}),(0,s.jsx)("option",{value:"last_3d_incl_today",children:"Last 3d"}),(0,s.jsx)("option",{value:"last_4d_incl_today",children:"Last 4d"}),(0,s.jsx)("option",{value:"last_5d_incl_today",children:"Last 5d"}),(0,s.jsx)("option",{value:"last_6d_incl_today",children:"Last 6d"}),(0,s.jsx)("option",{value:"last_7d_incl_today",children:"Last 7d"}),(0,s.jsx)("option",{value:"custom",children:"Custom…"})]}),(0,s.jsxs)("button",{onClick:async()=>{D(void 0);try{let e=[z];(null==et?void 0:et.campaign_id)&&e.push(String(et.campaign_id)),await ec(e,ed,ev)}catch(e){D(String((null==e?void 0:e.message)||e))}},disabled:eM,className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-700 hover:bg-emerald-800 text-white text-xs disabled:opacity-60",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 ".concat(eM?"animate-spin":"")})," ",ev?"Refresh calc":"Calculate"]}),ev&&(0,s.jsx)("button",{onClick:async()=>{if(window.confirm("Clear saved calculation for this campaign?"))try{let t=await (0,u.MA)({campaign_id:z,store:e,ad_account:a});if(null==t?void 0:t.error)throw Error(String(t.error));J(e=>{let t={...e};return delete t[z],t})}catch(e){D(String((null==e?void 0:e.message)||e))}},className:"rounded-xl font-semibold inline-flex items-center gap-2 px-3 py-1.5 bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs",children:"Clear"})]}),"custom"===eC&&(0,s.jsxs)("div",{className:"mt-2 flex items-center justify-end gap-1 text-xs",children:[(0,s.jsx)("input",{type:"date",value:(null===(f=K[z])||void 0===f?void 0:f.start)||j||"",onChange:e=>Q(t=>{var a;return{...t,[z]:{start:e.target.value,end:(null===(a=t[z])||void 0===a?void 0:a.end)||w}}}),className:"rounded-xl border px-2 py-1 bg-white"}),(0,s.jsx)("span",{children:"to"}),(0,s.jsx)("input",{type:"date",value:(null===(_=K[z])||void 0===_?void 0:_.end)||w||"",onChange:e=>Q(t=>{var a;return{...t,[z]:{start:(null===(a=t[z])||void 0===a?void 0:a.start)||j,end:e.target.value}}}),className:"rounded-xl border px-2 py-1 bg-white"})]})]})]},z||t.name)})]})]})})]})]})}},3541:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},1077:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},6706:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},2757:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},9061:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},7138:function(e,t,a){"use strict";a.d(t,{default:function(){return l.a}});var s=a(231),l=a.n(s)}},function(e){e.O(0,[472,231,264,971,23,744],function(){return e(e.s=8158)}),_N_E=e.O()}]);
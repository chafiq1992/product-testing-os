(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8211:function(t,e,n){Promise.resolve().then(n.bind(n,9011))},9011:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return h}});var a=n(7437),i=n(2265),c=n(2757);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,n(8030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var r=n(3787),s=n(6264),l=n(7138),u=n(6463),d=n(357);function p(t){let{children:e}=t;return(0,a.jsx)("div",{className:"bg-white border rounded-none shadow-sm",children:e})}function f(t){let{children:e,className:n=""}=t;return(0,a.jsx)("div",{className:"px-4 pt-4 ".concat(n),children:e})}function m(t){let{children:e,className:n=""}=t;return(0,a.jsx)("h3",{className:"font-semibold ".concat(n),children:e})}function g(t){let{children:e,className:n=""}=t;return(0,a.jsx)("div",{className:"px-4 pb-4 ".concat(n),children:e})}function h(){let[t,e]=(0,i.useState)([]),[n,h]=(0,i.useState)(!0),[y,x]=(0,i.useState)(!1),[_,w]=(0,i.useState)(!1),[v,b]=(0,i.useState)("irrakids"),N=(0,u.useRouter)(),j=d.env.NEXT_PUBLIC_API_BASE_URL||"";(0,i.useEffect)(()=>{(async()=>{try{let t="irrakids";try{t=localStorage.getItem("ptos_store")||"irrakids"}catch(t){}b(t);let n=await (0,s.Rd)(void 0,t);e((null==n?void 0:n.data)||[])}finally{h(!1)}})()},[]);let Z=d.env.NEXT_PUBLIC_STUDIO_URL||"";async function k(t){try{w(!0);let e=await (0,s.DO)({product:{audience:"",benefits:[],pain_points:[]},settings:{flow_type:t,store:v}}),n=null==e?void 0:e.id;if(!n){w(!1),x(!1);return}let a="&store=".concat(encodeURIComponent(v));"ads"===t?N.push("/ads/?id=".concat(n).concat(a)):"promotion"===t?N.push("/promotion/?id=".concat(n).concat(a)):N.push("/studio/?id=".concat(n).concat(a))}catch(t){}finally{w(!1),x(!1)}}return(0,a.jsxs)("div",{className:"min-h-screen w-full bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-sky-50 via-white to-indigo-50 text-slate-800",children:[(0,a.jsxs)("header",{className:"h-16 px-4 md:px-6 flex items-center justify-between border-b bg-white/70 backdrop-blur sticky top-0 z-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(c.Z,{className:"w-6 h-6 text-blue-600"}),(0,a.jsx)("h1",{className:"font-semibold text-lg",children:"Product Testing OS — Flows"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("select",{value:v,onChange:async t=>{let n=t.target.value;b(n);try{localStorage.setItem("ptos_store",n)}catch(t){}h(!0);try{let t=await (0,s.Rd)(void 0,n);e((null==t?void 0:t.data)||[])}finally{h(!1)}},className:"rounded-xl border px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"irrakids",children:"irrakids"}),(0,a.jsx)("option",{value:"irranova",children:"irranova"})]}),(0,a.jsx)(l.default,{href:"/",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:"Home"}),(0,a.jsx)(l.default,{href:"/ads-management",className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white",children:"Ads management"}),(0,a.jsxs)("button",{onClick:()=>x(!0),className:"rounded-xl font-semibold inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white",children:[(0,a.jsx)(o,{className:"w-4 h-4"})," New flow"]})]})]}),(0,a.jsxs)("div",{className:"p-4 md:p-6",children:[n&&(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"Loading…"}),!n&&0===t.length&&(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["No flows yet. Click ",(0,a.jsx)("span",{className:"font-medium",children:"New flow"})," to start."]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:t.map(t=>{let n=t.flow_type||"product",i="&store=".concat(encodeURIComponent(v)),c="ads"===n?"/ads/?id=".concat(t.id).concat(i):"promotion"===n?"/promotion/?id=".concat(t.id).concat(i):Z?"".concat(Z,"?id=").concat(t.id).concat(i):"/studio/?id=".concat(t.id).concat(i);async function o(n){n.preventDefault(),n.stopPropagation();try{if(!window.confirm("Delete this flow permanently? This will remove its local uploads."))return;let n=await (0,s.fE)(t.id);if(null==n?void 0:n.error){alert(String(n.error));return}e(e=>e.filter(e=>e.id!==t.id))}catch(t){alert("Delete failed: "+String((null==t?void 0:t.message)||t))}}return(0,a.jsx)(l.default,{href:c,className:"block",children:(0,a.jsxs)(p,{children:[(0,a.jsx)(f,{className:"pb-2",children:(0,a.jsxs)(m,{className:"text-base flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)("span",{children:(null==t?void 0:t.title)||"Untitled flow"}),(0,a.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded ".concat("ads"===n?"bg-emerald-100 text-emerald-700":"promotion"===n?"bg-fuchsia-100 text-fuchsia-700":"bg-blue-100 text-blue-700"),children:"ads"===n?"Create Ads":"promotion"===n?"Create Promotion":"Create Product"})]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{title:"Delete",onClick:o,className:"p-1 rounded hover:bg-slate-50 text-slate-500",children:"\xd7"}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:new Date(t.created_at||Date.now()).toLocaleDateString()})]})]})}),(0,a.jsxs)(g,{className:"space-y-2",children:[(0,a.jsx)("div",{className:"w-full bg-slate-100 rounded-none overflow-hidden border h-28 md:h-32",children:t.card_image?(0,a.jsx)("img",{src:function(t){try{if(!t||t.startsWith("/")||!/^https?:\/\//i.test(t))return t;let e=new URL(t).host,n="";try{n=j?new URL(j).host:window.location.host}catch(t){}return["cdn.shopify.com","images.openai.com","oaidalleapiprodscus.blob.core.windows.net"].some(t=>e===t||e.endsWith("."+t))||n&&e===n?t:"".concat(j,"/proxy/image?url=").concat(encodeURIComponent(t))}catch(e){return t}}(t.card_image),alt:"cover",className:"w-full h-full object-cover",loading:"lazy"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-slate-400 text-sm",children:"No image"})}),t.page_url&&(0,a.jsxs)("a",{href:t.page_url,target:"_blank",className:"text-sm inline-flex items-center gap-1 text-blue-600 hover:underline",children:[(0,a.jsx)(r.Z,{className:"w-3.5 h-3.5"})," ",t.page_url]}),!t.page_url&&(0,a.jsx)("div",{className:"text-sm text-slate-500",children:"No Shopify page yet"})]})]})},t.id)})})]}),y&&(0,a.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/30",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border shadow-xl w-[92vw] max-w-md p-4",children:[(0,a.jsx)("div",{className:"text-base font-semibold mb-2",children:"Choose a flow"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,a.jsxs)("button",{disabled:_,onClick:()=>k("product"),className:"border rounded-lg p-3 text-left hover:bg-slate-50",children:[(0,a.jsx)("div",{className:"font-medium",children:"Create Product"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"From product inputs to landing page"})]}),(0,a.jsxs)("button",{disabled:_,onClick:()=>k("ads"),className:"border rounded-lg p-3 text-left hover:bg-slate-50",children:[(0,a.jsx)("div",{className:"font-medium",children:"Create Ads"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Analyze landing URL, angles, copy, images"})]}),(0,a.jsxs)("button",{disabled:_,onClick:()=>k("promotion"),className:"border rounded-lg p-3 text-left hover:bg-slate-50",children:[(0,a.jsx)("div",{className:"font-medium",children:"Create Promotion"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Specialized for offers and promotional images"})]})]}),(0,a.jsx)("div",{className:"mt-3 flex justify-end gap-2",children:(0,a.jsx)("button",{onClick:()=>x(!1),className:"text-sm px-3 py-1.5 rounded border",children:"Cancel"})})]})})]})}},6264:function(t,e,n){"use strict";n.d(e,{$8:function(){return V},DO:function(){return l},HW:function(){return M},HX:function(){return _},JA:function(){return O},KQ:function(){return j},Ks:function(){return T},LJ:function(){return S},ME:function(){return d},Nm:function(){return A},PN:function(){return h},Q:function(){return J},Rd:function(){return p},Sv:function(){return k},V0:function(){return W},VI:function(){return N},WM:function(){return x},XD:function(){return u},_R:function(){return Q},_X:function(){return q},aW:function(){return H},dP:function(){return w},e1:function(){return L},eg:function(){return b},ew:function(){return K},fE:function(){return f},fh:function(){return R},hw:function(){return y},jZ:function(){return z},kY:function(){return B},l9:function(){return m},n4:function(){return s},oB:function(){return I},rU:function(){return X},sF:function(){return D},sP:function(){return E},sQ:function(){return U},sj:function(){return v},sm:function(){return Z},th:function(){return C},vz:function(){return F},xY:function(){return o},yD:function(){return r},yp:function(){return g},zO:function(){return P}});var a=n(8472);let i=n(357).env.NEXT_PUBLIC_API_BASE_URL||"";function c(){try{return localStorage.getItem("ptos_store")||void 0}catch(t){return}}async function o(t){let e=new FormData;for(let n of(e.append("audience",t.audience),e.append("benefits",JSON.stringify(t.benefits)),e.append("pain_points",JSON.stringify(t.pain_points)),null!=t.base_price&&e.append("base_price",String(t.base_price)),t.title&&e.append("title",t.title),Array.isArray(t.sizes)&&e.append("sizes",JSON.stringify(t.sizes)),Array.isArray(t.colors)&&e.append("colors",JSON.stringify(t.colors)),t.targeting&&e.append("targeting","string"==typeof t.targeting?t.targeting:JSON.stringify(t.targeting)),"boolean"==typeof t.advantage_plus&&e.append("advantage_plus",String(t.advantage_plus)),"number"==typeof t.adset_budget&&e.append("adset_budget",String(t.adset_budget)),t.model&&e.append("model",t.model),t.angles_prompt&&e.append("angles_prompt",t.angles_prompt),t.title_desc_prompt&&e.append("title_desc_prompt",t.title_desc_prompt),t.landing_copy_prompt&&e.append("landing_copy_prompt",t.landing_copy_prompt),t.images||[]))e.append("images",n);let{data:n}=await a.Z.post("".concat(i,"/api/tests"),e,{headers:{"Content-Type":"multipart/form-data"}});return n}async function r(t){let{data:e}=await a.Z.get("".concat(i,"/api/tests/").concat(t));return e}async function s(t){let{data:e}=await a.Z.get("".concat(i,"/api/tests/").concat(t,"?slim=1"));return e}async function l(t){var e,n;let o={...t,settings:{...t.settings||{},store:null!==(n=null==t?void 0:null===(e=t.settings)||void 0===e?void 0:e.store)&&void 0!==n?n:c()}},{data:r}=await a.Z.post("".concat(i,"/api/flows/draft"),o);return r}async function u(t,e){var n,o;let r={...e,settings:{...e.settings||{},store:null!==(o=null==e?void 0:null===(n=e.settings)||void 0===n?void 0:n.store)&&void 0!==o?o:c()}},{data:s}=await a.Z.put("".concat(i,"/api/flows/draft/").concat(t),r);return s}async function d(t){let{data:e}=await a.Z.get("".concat(i,"/api/flows/").concat(t));return e}async function p(t,e){let n=[];"number"==typeof t&&n.push("limit=".concat(t));let o=e||c();o&&n.push("store=".concat(encodeURIComponent(o)));let r=n.length?"?".concat(n.join("&")):"",{data:s}=await a.Z.get("".concat(i,"/api/flows").concat(r));return s}async function f(t){let{data:e}=await a.Z.delete("".concat(i,"/api/flows/").concat(t));return e}async function m(){let{data:t}=await a.Z.get("".concat(i,"/api/meta/audiences"));return t}async function g(t){let{data:e}=await a.Z.post("".concat(i,"/api/flows/ads/launch"),t);return e}async function h(t){let{data:e}=await a.Z.post("".concat(i,"/api/llm/angles"),t);return e}async function y(t){let{data:e}=await a.Z.post("".concat(i,"/api/llm/title_desc"),t);return e}async function x(t){let{data:e}=await a.Z.post("".concat(i,"/api/llm/landing_copy"),t);return e}async function _(t){let{data:e}=await a.Z.post("".concat(i,"/api/llm/analyze_landing_page"),t);return e}async function w(t){let{data:e}=await a.Z.post("".concat(i,"/api/meta/draft_image_campaign"),t);return e}async function v(t){let{data:e}=await a.Z.post("".concat(i,"/api/meta/draft_carousel_campaign"),t);return e}async function b(t){let e=new FormData;for(let n of t||[])e.append("files",n);let{data:n}=await a.Z.post("".concat(i,"/api/uploads"),e,{headers:{"Content-Type":"multipart/form-data"}});return n}async function N(t){let{data:e}=await a.Z.post("".concat(i,"/api/shopify/upload_images"),{...t,store:c()});return e}async function j(t){let{data:e}=await a.Z.post("".concat(i,"/api/shopify/product_create_from_title_desc"),{...t,store:c()});return e}async function Z(t){let{data:e}=await a.Z.post("".concat(i,"/api/shopify/update_title"),{...t,store:c()});return e}async function k(t){var e,n;let{data:o}=await a.Z.post("".concat(i,"/api/shopify/create_page_from_copy"),{...t,store:c()});return{page_url:null!==(n=null!==(e=null==o?void 0:o.page_url)&&void 0!==e?e:null==o?void 0:o.url)&&void 0!==n?n:void 0}}async function C(t){let{data:e}=await a.Z.post("".concat(i,"/api/shopify/configure_variants"),{...t,store:c()});return e}async function S(t){let e=new FormData;e.append("product_gid",t.product_gid),t.title&&e.append("title",t.title),t.description&&e.append("description",t.description),t.landing_copy&&e.append("landing_copy",JSON.stringify(t.landing_copy));let n=c();for(let a of(n&&e.append("store",n),t.files||[]))e.append("files",a);let{data:o}=await a.Z.post("".concat(i,"/api/shopify/upload_files"),e,{headers:{"Content-Type":"multipart/form-data"}});return o}async function R(t){var e;let n={...t,store:null!==(e=t.store)&&void 0!==e?e:c()},{data:o}=await a.Z.post("".concat(i,"/api/shopify/collection_products"),n);return o}async function P(t){let e=[],n=null!=t?t:c();n&&e.push("store=".concat(encodeURIComponent(n)));let o=e.length?"?".concat(e.join("&")):"",{data:r}=await a.Z.get("".concat(i,"/api/campaign_mappings").concat(o));return r}async function U(t){var e;let n={...t,store:null!==(e=t.store)&&void 0!==e?e:c()},{data:o}=await a.Z.post("".concat(i,"/api/campaign_mappings"),n);return o}async function I(t){let{data:e}=await a.Z.post("".concat(i,"/api/gemini/ad_image"),t);return e}async function D(t){let{data:e}=await a.Z.post("".concat(i,"/api/gemini/feature_benefit_set"),t);return e}async function z(t){let{data:e}=await a.Z.post("".concat(i,"/api/agent/execute"),t);return e}async function A(t){let{data:e}=await a.Z.post("".concat(i,"/api/translate"),t);return e}async function E(t){let{data:e}=await a.Z.get("".concat(i,"/api/agents").concat("number"==typeof t?"?limit=".concat(t):""));return e}async function L(t){let{data:e}=await a.Z.get("".concat(i,"/api/agents/").concat(t));return e}async function O(t,e){let{data:n}=await a.Z.put("".concat(i,"/api/agents/").concat(t),e);return n}async function M(t,e){let{data:n}=await a.Z.get("".concat(i,"/api/agents/").concat(t,"/runs").concat("number"==typeof e?"?limit=".concat(e):""));return n}async function T(t,e){let{data:n}=await a.Z.post("".concat(i,"/api/agents/").concat(t,"/runs"),e);return n}async function J(t,e,n){let{data:c}=await a.Z.put("".concat(i,"/api/agents/").concat(t,"/runs/").concat(e),n);return c}async function B(t,e){let{data:n}=await a.Z.get("".concat(i,"/api/agents/").concat(t,"/runs/").concat(e));return n}async function F(t){let{data:e}=await a.Z.post("".concat(i,"/api/llm/product_from_image"),t);return e}async function X(t){let{data:e}=await a.Z.post("".concat(i,"/api/gemini/variant_set"),t);return e}async function H(){let{data:t}=await a.Z.get("".concat(i,"/api/prompts"));return t}async function W(t){let{data:e}=await a.Z.post("".concat(i,"/api/prompts"),t);return e}async function q(t,e){let n=[];t&&n.push("date_preset=".concat(encodeURIComponent(t))),e&&n.push("ad_account=".concat(encodeURIComponent(e)));let c=n.length?"?".concat(n.join("&")):"",{data:o}=await a.Z.get("".concat(i,"/api/meta/campaigns").concat(c));return o}async function Q(t){var e,n;let o={...t,store:null!==(e=t.store)&&void 0!==e?e:c(),include_closed:null===(n=t.include_closed)||void 0===n||n,date_field:t.date_field},{data:r}=await a.Z.post("".concat(i,"/api/shopify/orders_count_by_title"),o);return r}async function V(t){var e;let n={...t,store:null!==(e=t.store)&&void 0!==e?e:c()},{data:o}=await a.Z.post("".concat(i,"/api/shopify/products_brief"),n);return o}async function K(t){var e,n;let o={...t,store:null!==(e=t.store)&&void 0!==e?e:c(),include_closed:null===(n=t.include_closed)||void 0===n||n,aggregate:t.aggregate,date_field:t.date_field},{data:r}=await a.Z.post("".concat(i,"/api/shopify/orders_count_by_collection"),o);return r}},3787:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n(8030).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},2757:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,n(8030).Z)("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},7138:function(t,e,n){"use strict";n.d(e,{default:function(){return i.a}});var a=n(231),i=n.n(a)},6463:function(t,e,n){"use strict";var a=n(1169);n.o(a,"useRouter")&&n.d(e,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(e,{useSearchParams:function(){return a.useSearchParams}})}},function(t){t.O(0,[472,231,971,23,744],function(){return t(t.s=8211)}),_N_E=t.O()}]);